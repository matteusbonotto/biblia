<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, viewport-fit=cover" />
  <meta name="theme-color" content="#25633b" />
  <meta name="description" content="App de miss√µes e estudo b√≠blico para crescimento espiritual." />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <title>Miss√µes e Estudo B√≠blico</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" />
  <link rel="stylesheet" href="assets/css/tema.css" />
  <link rel="stylesheet" href="assets/css/componentes.css" />
  <link rel="stylesheet" href="assets/css/utilidades.css" />
</head>
<body x-data="app" x-cloak>
  <template x-if="carregando && !usuario">
    <div class="d-flex align-items-center justify-content-center min-vh-100">
      <div class="spinner-border text-success" role="status"><span class="visually-hidden">Carregando‚Ä¶</span></div>
    </div>
  </template>

  <!-- Login -->
  <div x-show="pagina === 'login'" class="p-3 p-md-4" style="display: none;">
    <div class="max-w-400 mx-auto mt-5">
      <h1 class="text-center mb-4 texto-primario fw-600">Miss√µes e Estudo B√≠blico</h1>
      <p class="text-center texto-secundario mb-4">Entre para continuar sua jornada.</p>
      <div class="card-tema p-3 mb-3">
        <p x-show="erro" class="text-danger mb-2 fs-menor" x-text="erro"></p>
        <form @submit.prevent="fazerLogin()">
          <label class="form-label">E-mail</label>
          <input type="email" class="form-control mb-2" x-model="emailLogin" required />
          <label class="form-label">Senha</label>
          <input type="password" class="form-control mb-3" x-model="senhaLogin" required />
          <button type="submit" class="btn btn-primario w-100">Entrar</button>
        </form>
        <div class="mt-3 pt-3 border-top border-secondary">
          <button type="button" class="btn btn-outline-secondary w-100" @click="entrarModoDemo()">
            <i class="bi bi-play-circle me-1"></i> Demo
          </button>
          <p class="fs-menor texto-secundario text-center mt-2 mb-0">Testar o app sem criar conta</p>
        </div>
      </div>
      <p class="text-center">
        <a href="#cadastro" class="texto-primario">Criar conta</a>
      </p>
      <p class="text-center fs-menor mt-4">
        <a href="#termos" class="texto-secundario">Termos de Uso</a> ¬∑
        <a href="#sobre" class="texto-secundario">Sobre</a>
      </p>
    </div>
  </div>

  <!-- Cadastro em etapas -->
  <div x-show="pagina === 'cadastro'" class="p-3 p-md-4" style="display: none;">
    <div class="passo-cadastro">
      <h2 class="text-center mb-3 fw-600">Criar conta</h2>
      <div class="indicador-passos">
        <template x-for="i in 7" :key="i">
          <span :class="{ ativo: i - 1 === passoCadastro }"></span>
        </template>
      </div>
      <p x-show="erro" class="text-danger mb-2" x-text="erro"></p>

      <div x-show="passoCadastro === 0" class="card-tema p-3">
        <h3 class="fs-6 fw-600 mb-2">Termos de Uso e Pol√≠tica de Privacidade</h3>
        <p class="fs-menor mb-2">Para criar sua conta, voc√™ precisa <strong>ler e aceitar</strong> os termos abaixo. O cadastro s√≥ √© conclu√≠do ap√≥s o aceite.</p>
        <div class="termos-resumo">
          <h4>1. O que √© o app</h4>
          <p>Plataforma de crescimento espiritual e estudo b√≠blico com miss√µes, leitura da B√≠blia, quizzes, pontos (XP), ouro, ranking e conquistas. Uso pessoal e gratuito.</p>
          <h4>2. Aceite obrigat√≥rio</h4>
          <p>O aceite ser√° registrado com data e hora. Menores de 18 anos devem ter autoriza√ß√£o do respons√°vel.</p>
          <h4>3. Dados que coletamos (LGPD)</h4>
          <ul>
            <li>Nome, e-mail, senha, data de nascimento, estado civil, avatar e prefer√™ncias</li>
            <li>Progresso (miss√µes, leitura, quizzes) e registro de aceite dos termos</li>
            <li>N√£o vendemos seus dados; compartilhamos apenas com Supabase e APIs necess√°rias ao servi√ßo</li>
          </ul>
          <h4>4. Seus direitos</h4>
          <p>Acesso, corre√ß√£o, exclus√£o, portabilidade e revoga√ß√£o do consentimento. Contato: [e-mail do projeto].</p>
          <h4>5. Responsabilidade</h4>
          <p>O app √© oferecido "como est√°". Voc√™ √© respons√°vel por manter sua senha em sigilo.</p>
          <p class="mb-0"><a href="#termos" target="_blank" class="texto-primario">Ler termos completos</a></p>
        </div>
        <label class="d-flex align-items-start gap-2">
          <input type="checkbox" x-model="aceiteTermos" class="mt-1" />
          <span class="fs-menor">Li e aceito os Termos de Uso e a Pol√≠tica de Privacidade acima.</span>
        </label>
      </div>
      <div x-show="passoCadastro === 1" class="card-tema p-3">
        <label class="form-label">Como devo te chamar?</label>
        <input type="text" class="form-control mb-2" x-model="nomeCadastro" placeholder="Nome" />
        <input type="text" class="form-control" x-model="sobrenomeCadastro" placeholder="Sobrenome" />
      </div>
      <div x-show="passoCadastro === 2" class="card-tema p-3">
        <p class="mb-2">Que bom ter voc√™ aqui, <span x-text="nomeCadastro || '...'"></span>! Quantos anos voc√™ tem?</p>
        <label class="form-label">Data de nascimento</label>
        <input type="date" class="form-control" x-model="dataNascimentoCadastro" />
      </div>
      <div x-show="passoCadastro === 3" class="card-tema p-3">
        <label class="form-label">Qual seu e-mail?</label>
        <input type="email" class="form-control" x-model="emailCadastro" required />
      </div>
      <div x-show="passoCadastro === 4" class="card-tema p-3">
        <label class="form-label">Crie uma senha segura</label>
        <input type="password" class="form-control" x-model="senhaCadastro" minlength="6" required />
      </div>
      <div x-show="passoCadastro === 5" class="card-tema p-3">
        <label class="form-label">Qual seu status civil?</label>
        <select class="form-select" x-model="estadoCivilCadastro">
          <option value="">Selecione</option>
          <option value="solteiro">Solteiro(a)</option>
          <option value="casado">Casado(a)</option>
          <option value="outro">Outro</option>
        </select>
      </div>
      <div x-show="passoCadastro === 6" class="card-tema p-3 editor-personagem">
        <p class="text-center fw-600 mb-2">Crie seu personagem</p>
        <img :src="urlAvatar(configAvatarCadastro)" alt="Avatar" class="avatar-preview-grande" />

        <div class="grupo-opcao">
          <div class="grupo-opcao-titulo">Estilo</div>
          <div class="seletor-setas">
            <button type="button" class="btn-setas" @click="cicloOpcaoAvatar('avatarStyle', -1)" aria-label="Anterior"><i class="bi bi-chevron-left"></i></button>
            <span class="nome-opcao" x-text="labelOpcaoAvatar('avatarStyle')"></span>
            <button type="button" class="btn-setas" @click="cicloOpcaoAvatar('avatarStyle', 1)" aria-label="Pr√≥ximo"><i class="bi bi-chevron-right"></i></button>
          </div>
        </div>

        <div class="grupo-opcao">
          <div class="grupo-opcao-titulo">Cabelo</div>
          <div class="seletor-setas">
            <button type="button" class="btn-setas" @click="cicloOpcaoAvatar('topType', -1)" aria-label="Anterior"><i class="bi bi-chevron-left"></i></button>
            <span class="nome-opcao texto-truncado" x-text="labelOpcaoAvatar('topType')"></span>
            <button type="button" class="btn-setas" @click="cicloOpcaoAvatar('topType', 1)" aria-label="Pr√≥ximo"><i class="bi bi-chevron-right"></i></button>
          </div>
          <div class="swatches">
            <template x-for="op in opcoesAvataaars.hairColor" :key="op.valor">
              <button type="button" class="swatch" :class="{ ativo: configAvatarCadastro.hairColor === op.valor }" :style="'background:' + (op.hex || '#ccc')" :title="op.label" @click="selecionarOpcaoAvatar('hairColor', op.valor)" :aria-label="'Cor do cabelo: ' + op.label"></button>
            </template>
          </div>
        </div>

        <div class="grupo-opcao">
          <div class="grupo-opcao-titulo">Acess√≥rios</div>
          <div class="seletor-setas">
            <button type="button" class="btn-setas" @click="cicloOpcaoAvatar('accessoriesType', -1)" aria-label="Anterior"><i class="bi bi-chevron-left"></i></button>
            <span class="nome-opcao" x-text="labelOpcaoAvatar('accessoriesType')"></span>
            <button type="button" class="btn-setas" @click="cicloOpcaoAvatar('accessoriesType', 1)" aria-label="Pr√≥ximo"><i class="bi bi-chevron-right"></i></button>
          </div>
        </div>

        <div class="grupo-opcao">
          <div class="grupo-opcao-titulo">Barba / Bigode</div>
          <div class="seletor-setas">
            <button type="button" class="btn-setas" @click="cicloOpcaoAvatar('facialHairType', -1)" aria-label="Anterior"><i class="bi bi-chevron-left"></i></button>
            <span class="nome-opcao" x-text="labelOpcaoAvatar('facialHairType')"></span>
            <button type="button" class="btn-setas" @click="cicloOpcaoAvatar('facialHairType', 1)" aria-label="Pr√≥ximo"><i class="bi bi-chevron-right"></i></button>
          </div>
          <template x-if="configAvatarCadastro.facialHairType !== 'Blank'">
            <div class="swatches mt-2">
              <template x-for="op in opcoesAvataaars.facialHairColor" :key="op.valor">
                <button type="button" class="swatch" :class="{ ativo: configAvatarCadastro.facialHairColor === op.valor }" :style="'background:' + (op.hex || '#ccc')" @click="selecionarOpcaoAvatar('facialHairColor', op.valor)"></button>
              </template>
            </div>
          </template>
        </div>

        <div class="grupo-opcao">
          <div class="grupo-opcao-titulo">Roupa</div>
          <div class="seletor-setas">
            <button type="button" class="btn-setas" @click="cicloOpcaoAvatar('clotheType', -1)" aria-label="Anterior"><i class="bi bi-chevron-left"></i></button>
            <span class="nome-opcao" x-text="labelOpcaoAvatar('clotheType')"></span>
            <button type="button" class="btn-setas" @click="cicloOpcaoAvatar('clotheType', 1)" aria-label="Pr√≥ximo"><i class="bi bi-chevron-right"></i></button>
          </div>
          <div class="swatches">
            <template x-for="op in opcoesAvataaars.clotheColor" :key="op.valor">
              <button type="button" class="swatch" :class="{ ativo: configAvatarCadastro.clotheColor === op.valor }" :style="'background:' + (op.hex || '#ccc')" @click="selecionarOpcaoAvatar('clotheColor', op.valor)"></button>
            </template>
          </div>
        </div>

        <div class="grupo-opcao">
          <div class="grupo-opcao-titulo">Olhos</div>
          <div class="seletor-setas">
            <button type="button" class="btn-setas" @click="cicloOpcaoAvatar('eyeType', -1)" aria-label="Anterior"><i class="bi bi-chevron-left"></i></button>
            <span class="nome-opcao" x-text="labelOpcaoAvatar('eyeType')"></span>
            <button type="button" class="btn-setas" @click="cicloOpcaoAvatar('eyeType', 1)" aria-label="Pr√≥ximo"><i class="bi bi-chevron-right"></i></button>
          </div>
        </div>

        <div class="grupo-opcao">
          <div class="grupo-opcao-titulo">Sobrancelhas</div>
          <div class="seletor-setas">
            <button type="button" class="btn-setas" @click="cicloOpcaoAvatar('eyebrowType', -1)" aria-label="Anterior"><i class="bi bi-chevron-left"></i></button>
            <span class="nome-opcao" x-text="labelOpcaoAvatar('eyebrowType')"></span>
            <button type="button" class="btn-setas" @click="cicloOpcaoAvatar('eyebrowType', 1)" aria-label="Pr√≥ximo"><i class="bi bi-chevron-right"></i></button>
          </div>
        </div>

        <div class="grupo-opcao">
          <div class="grupo-opcao-titulo">Boca</div>
          <div class="seletor-setas">
            <button type="button" class="btn-setas" @click="cicloOpcaoAvatar('mouthType', -1)" aria-label="Anterior"><i class="bi bi-chevron-left"></i></button>
            <span class="nome-opcao" x-text="labelOpcaoAvatar('mouthType')"></span>
            <button type="button" class="btn-setas" @click="cicloOpcaoAvatar('mouthType', 1)" aria-label="Pr√≥ximo"><i class="bi bi-chevron-right"></i></button>
          </div>
        </div>

        <div class="grupo-opcao">
          <div class="grupo-opcao-titulo">Cor de pele</div>
          <div class="swatches">
            <template x-for="op in opcoesAvataaars.skinColor" :key="op.valor">
              <button type="button" class="swatch" :class="{ ativo: configAvatarCadastro.skinColor === op.valor }" :style="'background:' + (op.hex || '#ccc')" :title="op.label" @click="selecionarOpcaoAvatar('skinColor', op.valor)"></button>
            </template>
          </div>
        </div>
      </div>

      <div class="d-flex gap-2 mt-3">
        <button type="button" class="btn btn-outline-secondary" @click="voltarCadastro()" x-show="passoCadastro > 0">Voltar</button>
        <button type="button" class="btn btn-primario flex-grow-1" @click="avancarCadastro()"
          x-text="passoCadastro === 6 ? 'Criar conta' : 'Continuar'"
          :disabled="(passoCadastro === 0 && !aceiteTermos) || (passoCadastro === 3 && !emailCadastro) || (passoCadastro === 4 && senhaCadastro.length < 6) || carregando"></button>
      </div>
      <p class="text-center mt-3"><a href="#login" class="texto-primario">J√° tenho conta</a></p>
    </div>
  </div>

  <!-- HUD + √°rea logada (header e footer fixos; scroll s√≥ no conte√∫do) -->
  <template x-if="usuario">
    <div class="layout-logado">
      <header class="hud-topo">
        <div>
          <span class="nivel-xp" x-text="'N√≠vel ' + (nivel?.nivel || 1)"></span>
          <div class="progresso-xp mt-1">
            <div class="barra" :style="'width:' + Math.min(100, ((nivel?.xp_total || 0) % 100)) + '%'"></div>
          </div>
        </div>
        <div class="ouro-streak">
          <!-- Cora√ß√µes (vidas) -->
          <div class="coracoes-hud" :title="coracoes?.atual < coracoes?.maximo ? 'Pr√≥xima regenera√ß√£o: ' + tempoRestanteRegeneracao() : 'Cora√ß√µes cheios!'">
            <template x-for="i in (coracoes?.maximo || 5)" :key="i">
              <i class="bi" 
                 :class="i <= (coracoes?.atual || 0) ? 'bi-heart-fill coracao-cheio' : 'bi-heart coracao-vazio'"
                 :style="i <= (coracoes?.atual || 0) ? 'color: #e74c3c;' : 'color: #ccc;'"></i>
            </template>
          </div>
          <span x-text="(moeda?.ouro ?? 0) + ' ouro'"></span>
          <span class="ms-2" x-text="(nivel?.dias_sequencia ?? 0) + ' dias'"></span>
        </div>
      </header>

      <main class="area-principal p-3">
        <p x-show="erro" class="alert alert-danger py-2" x-text="erro"></p>
        <p x-show="sucesso" class="alert alert-success py-2" x-text="sucesso"></p>

        <nav x-show="pagina !== 'home'" class="mb-2" aria-label="Voltar">
          <a href="#home" class="btn btn-link btn-sm p-0 texto-primario"><i class="bi bi-arrow-left"></i> In√≠cio</a>
        </nav>

        <!-- Home -->
        <div x-show="pagina === 'home'" style="display: none;">
          <h2 class="titulo-pagina mb-1">Ol√°, <span x-text="perfil?.nome || 'amigo'"></span>!</h2>
          <p class="subtitulo-pagina mb-3">Resumo do dia e atalhos r√°pidos</p>
          <div class="mb-3" x-show="efeitosAtivos.length">
            <span class="fs-menor texto-secundario">Efeitos ativos: </span>
            <template x-for="e in efeitosAtivos" :key="e.id">
              <span class="efeito-ativo me-1" x-text="(e.itens?.nome || '') + ' ‚Äì ' + tempoRestante(e.termina_em)"></span>
            </template>
          </div>
          <p class="texto-secundario mb-3">A√ß√µes r√°pidas</p>
          <div class="acoes-rapidas mb-4">
            <button type="button" @click="orarParaGanharCoracao()" title="Orar para ganhar 1 cora√ß√£o (1x por dia)">
              <i class="bi bi-heart-fill"></i> Orar
            </button>
            <button type="button" @click="registrarAcaoRapida('perdoar')"><i class="bi bi-hand-thumbs-up"></i> Perdoar</button>
            <button type="button" @click="registrarAcaoRapida('confessar')"><i class="bi bi-chat-dots"></i> Confessar</button>
            <button type="button" @click="registrarAcaoRapida('interceder')"><i class="bi bi-people"></i> Interceder</button>
          </div>
          <p class="fw-600 mb-2">Atalhos</p>
          <div class="atalhos-home">
            <a href="#missoes"><i class="bi bi-flag"></i> Miss√µes</a>
            <a href="#leitura-biblia"><i class="bi bi-book"></i> Leitura B√≠blia</a>
            <a href="#estudo"><i class="bi bi-journal-bookmark"></i> Estudo do evangelho</a>
            <a href="#inventario"><i class="bi bi-backpack"></i> Invent√°rio</a>
            <a href="#loja"><i class="bi bi-shop"></i> Loja</a>
            <a href="#ranking"><i class="bi bi-trophy"></i> Ranking</a>
            <a href="#perfil"><i class="bi bi-person"></i> Perfil</a>
            <a href="#configuracoes"><i class="bi bi-gear"></i> Configura√ß√µes</a>
          </div>
        </div>

        <!-- Loja -->
        <div x-show="pagina === 'loja'" style="display: none;" class="loja-rpg">
          <div class="loja-header mb-4">
            <h2 class="titulo-pagina mb-1">üè™ Loja do Reino</h2>
            <div class="loja-saldo">
              <i class="bi bi-coin"></i>
              <span class="fw-600" x-text="(moeda?.ouro ?? 0)"></span>
              <span class="texto-secundario">ouro</span>
            </div>
          </div>

          <!-- Filtros e Visualiza√ß√£o -->
          <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap gap-2">
            <div class="loja-filtros">
              <button class="btn-filtro" :class="{ ativo: filtroLoja === null }" @click="filtroLoja = null">Todos</button>
              <button class="btn-filtro" :class="{ ativo: filtroLoja === 'consumivel' }" @click="filtroLoja = 'consumivel'">Consum√≠veis</button>
              <button class="btn-filtro" :class="{ ativo: filtroLoja === 'armadura' }" @click="filtroLoja = 'armadura'">Armadura</button>
              <button class="btn-filtro" :class="{ ativo: filtroLoja === 'permanente' }" @click="filtroLoja = 'permanente'">Permanentes</button>
            </div>
            <div class="btn-group">
              <button class="btn btn-sm" :class="viewLoja === 'grid' ? 'btn-primario' : 'btn-outline-secondary'" @click="viewLoja = 'grid'">
                <i class="bi bi-grid-3x3-gap"></i>
              </button>
              <button class="btn btn-sm" :class="viewLoja === 'lista' ? 'btn-primario' : 'btn-outline-secondary'" @click="viewLoja = 'lista'">
                <i class="bi bi-list-ul"></i>
              </button>
            </div>
          </div>

          <!-- Vitrine de Itens -->
          <div class="loja-vitrine" :class="viewLoja === 'lista' ? 'lista-view' : ''">
            <template x-for="item in itensLojaFiltrados" :key="item.id">
              <div class="item-card" :class="'raridade-' + (item.raridade || 'comum')" 
                   :title="item.descricao"
                   @click="abrirDetalhesItem(item)">
                <!-- Badge de Raridade -->
                <div class="item-raridade-badge" x-text="getRaridadeNome(item.raridade || 'comum')"></div>
                
                <!-- Imagem do Item -->
                <div class="item-imagem">
                  <i :class="'bi ' + (item.icone || 'bi-box')"></i>
                </div>
                
                <!-- Nome e N√≠vel -->
                <div class="item-info">
                  <h4 class="item-nome" x-text="item.nome"></h4>
                  <div class="item-meta">
                    <span class="item-nivel" x-text="'Nv. ' + (item.nivel_requerido || 1)"></span>
                    <span class="item-tipo" x-text="item.categoria || item.tipo"></span>
                  </div>
                </div>
                
                <!-- Pre√ßo e Dura√ß√£o -->
                <div class="item-footer">
                  <div class="item-preco">
                    <i class="bi bi-coin"></i>
                    <span x-text="item.preco_ouro"></span>
                  </div>
                  <div class="item-duracao" x-show="item.duracao_minutos" x-text="item.duracao_minutos + ' min'"></div>
                </div>
                
                <!-- Bot√£o Comprar -->
                <button class="btn-comprar" 
                        @click.stop="comprarItem(item)" 
                        :disabled="(moeda?.ouro ?? 0) < item.preco_ouro || (nivel?.nivel ?? 1) < (item.nivel_requerido || 1)"
                        :class="{ 'sem-recursos': (moeda?.ouro ?? 0) < item.preco_ouro || (nivel?.nivel ?? 1) < (item.nivel_requerido || 1) }">
                  <template x-if="(moeda?.ouro ?? 0) < item.preco_ouro">
                    <span>Sem ouro</span>
                  </template>
                  <template x-if="(moeda?.ouro ?? 0) >= item.preco_ouro && (nivel?.nivel ?? 1) < (item.nivel_requerido || 1)">
                    <span>N√≠vel insuficiente</span>
                  </template>
                  <template x-if="(moeda?.ouro ?? 0) >= item.preco_ouro && (nivel?.nivel ?? 1) >= (item.nivel_requerido || 1)">
                    <span>Comprar</span>
                  </template>
                </button>
              </div>
            </template>
          </div>

          <!-- Modal de Detalhes do Item -->
          <div class="modal-overlay" x-show="modalItemDetalhes" @click="fecharDetalhesItem()" style="display: none;">
            <div class="modal-item-detalhes" @click.stop>
              <button class="modal-fechar" @click="fecharDetalhesItem()"><i class="bi bi-x-lg"></i></button>
              <template x-if="itemSelecionado">
                <div>
                  <div class="item-detalhes-header" :class="'raridade-' + (itemSelecionado.raridade || 'comum')">
                    <div class="item-detalhes-imagem">
                      <i :class="'bi ' + (itemSelecionado.icone || 'bi-box')"></i>
                    </div>
                    <h3 x-text="itemSelecionado.nome"></h3>
                    <span class="item-detalhes-raridade" x-text="getRaridadeNome(itemSelecionado.raridade || 'comum')"></span>
                  </div>
                  <div class="item-detalhes-corpo">
                    <p class="item-detalhes-descricao" x-text="itemSelecionado.descricao"></p>
                    <div class="item-detalhes-stats">
                      <div class="stat-item">
                        <i class="bi bi-star-fill"></i>
                        <span>N√≠vel: <strong x-text="itemSelecionado.nivel_requerido || 1"></strong></span>
                      </div>
                      <div class="stat-item" x-show="itemSelecionado.duracao_minutos">
                        <i class="bi bi-clock"></i>
                        <span>Dura√ß√£o: <strong x-text="itemSelecionado.duracao_minutos + ' minutos'"></strong></span>
                      </div>
                      <div class="stat-item">
                        <i class="bi bi-tag"></i>
                        <span>Tipo: <strong x-text="itemSelecionado.categoria || itemSelecionado.tipo"></strong></span>
                      </div>
                    </div>
                    <div class="item-detalhes-preco">
                      <i class="bi bi-coin"></i>
                      <span x-text="itemSelecionado.preco_ouro"></span>
                      <span class="texto-secundario">ouro</span>
                    </div>
                    <button class="btn btn-primario w-100 mt-3" 
                            @click="comprarItem(itemSelecionado); fecharDetalhesItem()"
                            :disabled="(moeda?.ouro ?? 0) < itemSelecionado.preco_ouro || (nivel?.nivel ?? 1) < (itemSelecionado.nivel_requerido || 1)">
                      Comprar Agora
                    </button>
                  </div>
                </div>
              </template>
            </div>
          </div>
        </div>

        <!-- Estudo do evangelho (reformado/calvinista, 100% B√≠blia) -->
        <div x-show="pagina === 'estudo'" style="display: none;">
          <!-- Barra de progresso global (trilhas e dentro de aulas) -->
          <div class="mb-3" x-show="viewEstudo === 'trilhas' || viewEstudo === 'aulas'">
            <div class="d-flex justify-content-between align-items-center fs-menor texto-secundario mb-1">
              <span>Progresso do estudo</span>
              <span x-show="viewEstudo === 'trilhas'" x-text="aulasCompletasEstudo() + ' / ' + totalAulasEstudo() + ' aulas'"></span>
              <span x-show="viewEstudo === 'aulas' && trilhaSelecionadaEstudo" x-text="aulasCompletasNaTrilha(trilhaSelecionadaEstudo) + ' / ' + totalAulasNaTrilha(trilhaSelecionadaEstudo) + ' aulas desta trilha'"></span>
            </div>
            <div class="barra-progresso-tema" style="height: 8px;">
              <div class="preenchimento" :style="'width:' + (viewEstudo === 'aulas' && trilhaSelecionadaEstudo ? percentualTrilhaEstudo(trilhaSelecionadaEstudo) : percentualProgressoEstudo()) + '%'"></div>
            </div>
          </div>

          <template x-if="viewEstudo === 'trilhas'">
            <div>
              <h2 class="titulo-pagina mb-1">Estudo do evangelho</h2>
              <p class="subtitulo-pagina mb-3">Trilhas de doutrina reformada e calvinista presbiteriana, 100% baseadas na B√≠blia.</p>
              <div class="estudo-trilhas">
                <template x-for="trilha in TRILHAS_ESTUDO" :key="trilha.id">
                  <button type="button" class="estudo-card-trilha card-tema p-3 mb-2 w-100 text-start d-flex align-items-center gap-3" @click="selecionarTrilhaEstudo(trilha)">
                    <span class="estudo-icone-trilha"><i :class="trilha.icone"></i></span>
                    <div class="flex-grow-1">
                      <div class="d-flex justify-content-between align-items-center gap-2">
                        <span class="fw-600" x-text="trilha.titulo"></span>
                        <span class="fs-menor texto-primario fw-600" x-text="aulasCompletasNaTrilha(trilha) + '/' + totalAulasNaTrilha(trilha)"></span>
                      </div>
                      <p class="fs-menor texto-secundario mb-1 mt-1" x-text="trilha.descricao"></p>
                      <div class="barra-progresso-tema" style="height: 4px;">
                        <div class="preenchimento" :style="'width:' + percentualTrilhaEstudo(trilha) + '%'"></div>
                      </div>
                    </div>
                    <i class="bi bi-chevron-right texto-secundario"></i>
                  </button>
                </template>
              </div>
            </div>
          </template>

          <template x-if="viewEstudo === 'aulas' && trilhaSelecionadaEstudo">
            <div>
              <button type="button" class="btn btn-link btn-sm p-0 mb-2 texto-primario" @click="voltarEstudoTrilhas()"><i class="bi bi-arrow-left"></i> Trilhas</button>
              <h2 class="titulo-pagina mb-1" x-text="trilhaSelecionadaEstudo.titulo"></h2>
              <p class="subtitulo-pagina mb-2" x-text="trilhaSelecionadaEstudo.descricao"></p>
              <p class="fs-menor texto-secundario mb-3" x-text="aulasCompletasNaTrilha(trilhaSelecionadaEstudo) + ' de ' + totalAulasNaTrilha(trilhaSelecionadaEstudo) + ' aulas conclu√≠das'"></p>
              <div class="estudo-aulas">
                <template x-for="(aula, idx) in trilhaSelecionadaEstudo.aulas" :key="aula.id">
                  <button type="button" class="estudo-card-aula card-tema p-3 mb-2 w-100 text-start" @click="selecionarAulaEstudo(aula)">
                    <div class="d-flex justify-content-between align-items-start gap-2">
                      <div>
                        <span class="estudo-num-aula fs-menor texto-primario fw-600" x-text="'Aula ' + (idx + 1)"></span>
                        <span x-show="aulaConcluidaEstudo(aula)" class="badge bg-primary ms-1">Lida</span>
                        <span x-show="aulaCompletaEstudo(aula)" class="badge bg-success ms-1"><i class="bi bi-check-circle"></i> Conclu√≠da</span>
                        <div class="fw-600 mt-1" x-text="aula.titulo"></div>
                        <p class="fs-menor texto-secundario mb-0 mt-1" x-text="(aula.refsBiblicas || []).join(' ¬∑ ')"></p>
                      </div>
                      <i class="bi bi-chevron-right texto-secundario"></i>
                    </div>
                  </button>
                </template>
              </div>
              <!-- Quiz do m√≥dulo (fim de trilha) para aprova√ß√£o -->
              <div class="card-tema p-3 mt-3" x-show="trilhaTemQuizModulo(trilhaSelecionadaEstudo)">
                <h3 class="subtitulo-secao mb-2">Quiz do m√≥dulo</h3>
                <p class="fs-menor texto-secundario mb-2">Prova sobre todo o conte√∫do da trilha. Aprova√ß√£o a partir de 70%.</p>
                <template x-if="moduloAprovadoEstudo(trilhaSelecionadaEstudo.id)">
                  <p class="texto-primario fw-600 mb-0"><i class="bi bi-check-circle-fill me-1"></i> M√≥dulo aprovado</p>
                </template>
                <template x-if="!moduloAprovadoEstudo(trilhaSelecionadaEstudo.id)">
                  <button type="button" class="btn btn-primario w-100" @click="iniciarQuizModuloEstudo()">
                    <i class="bi bi-patch-question me-1"></i> Fazer quiz do m√≥dulo
                  </button>
                </template>
              </div>
            </div>
          </template>

          <template x-if="viewEstudo === 'aula' && aulaSelecionadaEstudo">
            <div>
              <h2 class="titulo-pagina mb-2" x-text="aulaSelecionadaEstudo.titulo"></h2>
              <div class="mb-3">
                <template x-for="ref in (aulaSelecionadaEstudo.refsBiblicas || [])" :key="ref">
                  <span class="badge bg-secondary me-1 mb-1" x-text="ref"></span>
                </template>
              </div>
              <div class="conteudo-legal card-tema p-3 mb-3">
                <template x-for="(paragrafo, i) in (aulaSelecionadaEstudo.conteudo || [])" :key="i">
                  <p class="mb-3" x-text="paragrafo"></p>
                </template>
              </div>
              <!-- Estado: aula conclu√≠da (marcada como lida) -->
              <div class="card-tema p-3 mb-3" x-show="aulaAtualMarcadaLida">
                <p class="texto-primario fw-600 mb-0"><i class="bi bi-check-circle-fill me-1"></i> Aula conclu√≠da</p>
                <p class="fs-menor texto-secundario mb-0 mt-1" x-show="aulaTemQuiz(aulaSelecionadaEstudo) && !aulaQuizAprovadoEstudo(aulaSelecionadaEstudo.id)">Fa√ßa o quiz para consolidar.</p>
                <p class="fs-menor texto-secundario mb-0 mt-1" x-show="aulaCompletaEstudo(aulaSelecionadaEstudo)">Quiz aprovado.</p>
              </div>
              <!-- Fila de a√ß√µes: Voltar | Toggle Marcar como lida / Lida | Pr√≥ximo -->
              <div class="d-flex flex-wrap align-items-center justify-content-between gap-2">
                <button type="button" class="btn btn-outline-secondary" @click="voltarEstudoAulas()"><i class="bi bi-arrow-left me-1"></i> Voltar</button>
                <div class="d-flex align-items-center gap-2">
                  <button type="button"
                    :class="aulaAtualMarcadaLida ? 'btn btn-outline-primary' : 'btn btn-primario'"
                    @click="toggleLidaEstudo()">
                    <i :class="aulaAtualMarcadaLida ? 'bi bi-check-circle-fill me-1' : 'bi bi-check-lg me-1'"></i>
                    <span x-text="aulaAtualMarcadaLida ? 'Lida' : 'Marcar como lida'"></span>
                  </button>
                  <template x-if="aulaAtualMarcadaLida && aulaTemQuiz(aulaSelecionadaEstudo) && !aulaQuizAprovadoEstudo(aulaSelecionadaEstudo.id)">
                    <button type="button" class="btn btn-outline-primary" @click="iniciarQuizEstudo()"><i class="bi bi-patch-question me-1"></i> Fazer quiz</button>
                  </template>
                </div>
                <template x-if="proximaAulaEstudo()">
                  <button type="button" class="btn btn-primario" @click="irParaProximaAulaEstudo()"><i class="bi bi-arrow-right-circle me-1"></i> Pr√≥ximo</button>
                </template>
                <template x-if="!proximaAulaEstudo() && trilhaSelecionadaEstudo">
                  <button type="button" class="btn btn-outline-primary" @click="voltarEstudoAulas()"><i class="bi bi-list-ul me-1"></i> Voltar √†s aulas</button>
                </template>
              </div>
            </div>
          </template>

          <!-- Quiz do estudo (aula ou m√≥dulo) -->
          <template x-if="viewEstudo === 'quiz' && (aulaSelecionadaEstudo || (quizEstudoTipo === 'modulo' && trilhaSelecionadaEstudo))">
            <div>
              <button type="button" class="btn btn-link btn-sm p-0 mb-2 texto-primario" @click="voltarQuizParaAula()">
                <i class="bi bi-arrow-left"></i> <span x-text="quizEstudoTipo === 'modulo' ? 'Voltar √†s aulas' : 'Voltar √† aula'"></span>
              </button>
              <h2 class="titulo-pagina mb-1" x-text="quizEstudoTipo === 'modulo' ? ('Quiz do m√≥dulo: ' + (trilhaSelecionadaEstudo?.titulo || '')) : ('Quiz: ' + (aulaSelecionadaEstudo?.titulo || ''))"></h2>
              <p class="subtitulo-pagina mb-3">Aprova√ß√£o a partir de 70%</p>
              
              <!-- Aviso de cora√ß√µes insuficientes -->
              <div class="alert alert-warning mb-3" x-show="!temCoracoesSuficientes()">
                <i class="bi bi-heartbreak me-2"></i>
                <strong>Sem cora√ß√µes!</strong> Voc√™ precisa de pelo menos 1 cora√ß√£o para fazer o quiz.
                <div class="mt-2">
                  <button type="button" class="btn btn-sm btn-outline-primary me-2" @click="orarParaGanharCoracao()">
                    <i class="bi bi-heart me-1"></i> Orar (ganha 1 cora√ß√£o)
                  </button>
                  <a href="#loja" class="btn btn-sm btn-outline-primary">
                    <i class="bi bi-shop me-1"></i> Comprar cora√ß√µes
                  </a>
                </div>
              </div>
              
              <!-- Quiz em andamento - uma pergunta por vez -->
              <div x-show="!quizEstudoEnviado && quizEstudoPerguntas && quizEstudoPerguntas.length > 0 && temCoracoesSuficientes()" class="quiz-container-duolingo" style="display: none;">
                  <!-- Barra de progresso -->
                  <div class="quiz-progresso mb-3">
                    <div class="quiz-progresso-bar" :style="'width: ' + ((quizEstudoPerguntaAtual + 1) / quizEstudoPerguntas.length * 100) + '%'"></div>
                    <span class="quiz-progresso-texto" x-text="(quizEstudoPerguntaAtual + 1) + ' / ' + quizEstudoPerguntas.length"></span>
                  </div>
                  
                  <!-- Pergunta atual com anima√ß√£o de slide -->
                  <div class="quiz-pergunta-wrapper" x-transition:enter="quiz-slide-enter" x-transition:enter-start="quiz-slide-enter-start" x-transition:enter-end="quiz-slide-enter-end">
                    <div class="quiz-pergunta-card card-tema p-4">
                      <h3 class="quiz-pergunta-titulo mb-4" x-text="quizEstudoPerguntas[quizEstudoPerguntaAtual]?.pergunta"></h3>
                      
                      <div class="quiz-alternativas">
                        <template x-for="(alt, i) in quizEstudoPerguntas[quizEstudoPerguntaAtual]?.alternativas" :key="i">
                          <button 
                            type="button"
                            class="quiz-alternativa-btn"
                            :class="{
                              'quiz-alternativa-selecionada': quizEstudoRespostaSelecionada === i,
                              'quiz-alternativa-correta': quizEstudoFeedback === 'correto' && i === quizEstudoPerguntas[quizEstudoPerguntaAtual]?.correta,
                              'quiz-alternativa-errada': quizEstudoFeedback === 'errado' && quizEstudoRespostaSelecionada === i && i !== quizEstudoPerguntas[quizEstudoPerguntaAtual]?.correta
                            }"
                            @click="selecionarRespostaQuizEstudo(i)"
                            :disabled="quizEstudoFeedback !== null">
                            <span class="quiz-alternativa-texto" x-text="alt"></span>
                            <i x-show="quizEstudoFeedback === 'correto' && i === quizEstudoPerguntas[quizEstudoPerguntaAtual]?.correta" class="bi bi-check-circle-fill quiz-feedback-icon"></i>
                            <i x-show="quizEstudoFeedback === 'errado' && quizEstudoRespostaSelecionada === i" class="bi bi-x-circle-fill quiz-feedback-icon"></i>
                          </button>
                        </template>
                      </div>
                    </div>
                  </div>
                </div>
              <template x-if="quizEstudoEnviado">
                <div class="card-tema p-3" :class="quizEstudoNota >= 70 ? 'border-success' : 'border-warning'">
                  <p class="fw-600 mb-1" x-text="'Nota: ' + quizEstudoNota + '%'"></p>
                  <p x-show="quizEstudoNota >= 70" class="texto-primario mb-2" x-text="quizEstudoTipo === 'modulo' ? 'M√≥dulo aprovado! Parab√©ns.' : 'Aprovado! Aula consolidada no progresso.'"></p>
                  <p x-show="quizEstudoNota < 70" class="text-warning mb-2">Tente novamente. Revise o conte√∫do e refa√ßa o quiz.</p>
                  <button type="button" class="btn btn-outline-secondary" @click="voltarQuizParaAula()" x-text="quizEstudoTipo === 'modulo' ? 'Voltar √†s aulas' : 'Voltar √† aula'"></button>
                </div>
              </template>
            </div>
          </template>
        </div>

        <!-- Conquistas (placeholder) -->
        <div x-show="pagina === 'conquistas'" style="display: none;">
          <h2 class="titulo-pagina mb-1">Conquistas</h2>
          <p class="subtitulo-pagina mb-3">Medalhas e marcos desbloqueados na sua jornada</p>
          <div class="card-tema p-3">
            <p class="texto-secundario mb-0">Em breve: lista de conquistas desbloqueadas.</p>
          </div>
        </div>

        <!-- Perfil -->
        <div x-show="pagina === 'perfil'" style="display: none;">
          <h2 class="titulo-pagina mb-1">Perfil</h2>
          <p class="subtitulo-pagina mb-3">Seus dados e progresso na jornada</p>
          <div class="text-center mb-3">
            <img :src="urlAvatar(perfil?.config_avatar)" alt="Avatar" class="avatar-grande" />
          </div>
          <div class="card-tema p-3 mb-3">
            <p><strong x-text="(perfil?.nome || '') + ' ' + (perfil?.sobrenome || '')"></strong></p>
            <p class="fs-menor texto-secundario mb-0" x-text="'N√≠vel ' + (nivel?.nivel || 1) + ' ¬∑ ' + (nivel?.xp_total || 0) + ' XP total ¬∑ ' + (nivel?.dias_sequencia || 0) + ' dias de sequ√™ncia'"></p>
          </div>
          <!-- Atributos: Obras da carne e Fruto do Esp√≠rito (Gl 5) com tooltips -->
          <h3 class="subtitulo-secao mb-2">
            <span :title="REFS_BIBLICAS.FRUTO_ESPIRITO">Fruto do Esp√≠rito</span>
            <i class="bi bi-info-circle ms-1 texto-secundario" :title="REFS_BIBLICAS.FRUTO_ESPIRITO"></i>
          </h3>
          <div class="card-tema p-3 mb-2">
            <p class="fs-menor texto-secundario mb-2" :title="REFS_BIBLICAS.FRUTO_ESPIRITO">G√°latas 5.22-23</p>
            <div class="d-flex flex-wrap gap-1">
              <template x-for="fruto in FRUTO_DO_ESPIRITO" :key="fruto">
                <span class="badge bg-success" :title="REFS_BIBLICAS.FRUTO_ESPIRITO" x-text="fruto"></span>
              </template>
            </div>
          </div>
          <h3 class="subtitulo-secao mb-2">
            <span :title="REFS_BIBLICAS.OBRAS_CARNE">Obras da carne</span>
            <i class="bi bi-info-circle ms-1 texto-secundario" :title="REFS_BIBLICAS.OBRAS_CARNE"></i>
          </h3>
          <div class="card-tema p-3">
            <p class="fs-menor texto-secundario mb-2" :title="REFS_BIBLICAS.OBRAS_CARNE">G√°latas 5.19-21</p>
            <div class="d-flex flex-wrap gap-1">
              <template x-for="obra in OBRAS_DA_CARNE" :key="obra">
                <span class="badge bg-secondary" :title="REFS_BIBLICAS.OBRAS_CARNE" x-text="obra"></span>
              </template>
            </div>
          </div>
        </div>

        <!-- Miss√µes -->
        <div x-show="pagina === 'missoes'" style="display: none;">
          <h2 class="titulo-pagina mb-1">Miss√µes</h2>
          <p class="subtitulo-pagina mb-3">Cumpra miss√µes e ganhe XP e ouro</p>

          <!-- M√©tricas e Legendas - Agrupamento Profissional -->
          <div class="metricas-legendas-wrapper">
            <!-- M√©tricas -->
            <div class="metricas-grupo">
              <div class="metrica-item-profissional">
                <span class="metrica-numero" x-text="filtroMissaoStatus === null ? (modelosMissoesFiltrados.length + totalMissoes) : totalMissoes"></span>
                <span class="metrica-nome">Total</span>
              </div>
              <div class="metrica-item-profissional">
                <span class="metrica-numero" x-text="metricasMissoes?.ativas || 0"></span>
                <span class="metrica-nome">Ativas</span>
              </div>
              <div class="metrica-item-profissional">
                <span class="metrica-numero" x-text="metricasMissoes?.concluidas || 0"></span>
                <span class="metrica-nome">Conclu√≠das</span>
              </div>
              <div class="metrica-item-profissional">
                <span class="metrica-numero" x-text="(metricasMissoes?.abandonadas || 0) + (metricasMissoes?.expiradas || 0)"></span>
                <span class="metrica-nome">N√£o conclu√≠das</span>
              </div>
            </div>

            <!-- Legendas agrupadas -->
            <div class="legendas-grupo">
              <div class="legenda-grupo-item">
                <span class="legenda-grupo-titulo">Status</span>
                <div class="legenda-itens-linha">
                  <div class="legenda-item-compacta" title="Miss√µes dispon√≠veis para iniciar">
                    <span class="legenda-cor" style="background: #ffffff; border: 1px solid #e0e0e0;"></span>
                    <span class="legenda-texto">Dispon√≠vel</span>
                  </div>
                  <div class="legenda-item-compacta" title="Miss√µes em andamento">
                    <span class="legenda-cor" style="background: #e3f2fd; border: 1px solid #2196f3;"></span>
                    <span class="legenda-texto">Em andamento</span>
                  </div>
                  <div class="legenda-item-compacta" title="Miss√µes conclu√≠das">
                    <span class="legenda-cor" style="background: #e8f5e9; border: 1px solid #4caf50;"></span>
                    <span class="legenda-texto">Conclu√≠da</span>
                  </div>
                  <div class="legenda-item-compacta" title="Miss√µes expiradas ou abandonadas">
                    <span class="legenda-cor" style="background: #fff3e0; border: 1px solid #ff9800;"></span>
                    <span class="legenda-texto">N√£o conclu√≠da</span>
                  </div>
                </div>
              </div>
              <div class="legenda-grupo-item">
                <span class="legenda-grupo-titulo">Categorias</span>
                <div class="legenda-itens-linha">
                  <div class="legenda-item-compacta" title="Miss√µes que envolvem valores humanos e relacionamentos">
                    <i class="bi bi-person-heart legenda-icone-tipo"></i>
                    <span class="legenda-texto">Humana</span>
                  </div>
                  <div class="legenda-item-compacta" title="Miss√µes relacionadas √† vida espiritual e comunh√£o com Deus">
                    <i class="bi bi-heart legenda-icone-tipo"></i>
                    <span class="legenda-texto">Espiritual</span>
                  </div>
                  <div class="legenda-item-compacta" title="Miss√µes de aprendizado e estudo b√≠blico">
                    <i class="bi bi-book legenda-icone-tipo"></i>
                    <span class="legenda-texto">Conhecimento</span>
                  </div>
                  <div class="legenda-item-compacta" title="Miss√µes de a√ß√µes pr√°ticas e servi√ßo">
                    <i class="bi bi-check-circle legenda-icone-tipo"></i>
                    <span class="legenda-texto">Tarefa</span>
                  </div>
                  <div class="legenda-item-compacta" title="Miss√µes para casais realizarem juntos">
                    <i class="bi bi-people legenda-icone-tipo"></i>
                    <span class="legenda-texto">Casal</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Filtros minimalistas -->
          <div class="filtros-missoes">
            <button type="button" class="filtro-btn" :class="{ ativo: filtroMissaoStatus === null }" @click="paginaMissoes = 1; filtroMissaoStatus = null; atualizarFiltrosMissoes()">Todas</button>
            <button type="button" class="filtro-btn" :class="{ ativo: filtroMissaoStatus === 'ativa' }" @click="paginaMissoes = 1; filtroMissaoStatus = 'ativa'; atualizarFiltrosMissoes()">Ativas</button>
            <button type="button" class="filtro-btn" :class="{ ativo: filtroMissaoStatus === 'concluida' }" @click="paginaMissoes = 1; filtroMissaoStatus = 'concluida'; atualizarFiltrosMissoes()">Conclu√≠das</button>
            <button type="button" class="filtro-btn" :class="{ ativo: filtroMissaoStatus === 'nao_concluidas' }" @click="paginaMissoes = 1; filtroMissaoStatus = 'nao_concluidas'; atualizarFiltrosMissoes()">N√£o Conclu√≠das</button>
            <button type="button" class="filtro-btn" :class="{ ativo: filtroMissaoTipo !== null }" @click="mostrarFiltroTipo = !mostrarFiltroTipo">
              <i class="bi bi-funnel me-1"></i> Tipo
            </button>
          </div>

          <!-- Filtro por tipo (dropdown) -->
          <div x-show="mostrarFiltroTipo" class="mb-3">
            <div class="d-flex gap-2 flex-wrap">
              <button type="button" class="filtro-btn" :class="{ ativo: filtroMissaoTipo === null }" @click="filtroMissaoTipo = null; atualizarFiltrosMissoes()">Todos</button>
              <button type="button" class="filtro-btn" :class="{ ativo: filtroMissaoTipo === 'humana' }" @click="filtroMissaoTipo = 'humana'; atualizarFiltrosMissoes()">Humanas</button>
              <button type="button" class="filtro-btn" :class="{ ativo: filtroMissaoTipo === 'espiritual' }" @click="filtroMissaoTipo = 'espiritual'; atualizarFiltrosMissoes()">Espirituais</button>
              <button type="button" class="filtro-btn" :class="{ ativo: filtroMissaoTipo === 'conhecimento' }" @click="filtroMissaoTipo = 'conhecimento'; atualizarFiltrosMissoes()">Conhecimento</button>
              <button type="button" class="filtro-btn" :class="{ ativo: filtroMissaoTipo === 'tarefa' }" @click="filtroMissaoTipo = 'tarefa'; atualizarFiltrosMissoes()">Tarefa</button>
              <button type="button" class="filtro-btn" :class="{ ativo: filtroMissaoTipo === 'casal' }" @click="filtroMissaoTipo = 'casal'; atualizarFiltrosMissoes()">Casal</button>
            </div>
          </div>

          <!-- Cards de miss√µes dispon√≠veis (modelos) - s√≥ mostra quando n√£o h√° filtro de status -->
          <template x-if="filtroMissaoStatus === null">
            <div>
              <p class="subtitulo-secao mb-3">Novas miss√µes dispon√≠veis <span class="texto-secundario fs-menor" x-text="'(' + modelosMissoesFiltrados.length + ')'"></span></p>
              <div class="cards-missoes-grid">
                <template x-for="mod in modelosMissoesFiltrados" :key="mod.id">
                  <div class="card-missao disponivel">
                    <!-- Header com √≠cone, t√≠tulo e status -->
                  <div class="card-missao-header">
                    <div class="card-missao-icone">
                      <i :class="'bi ' + (mod.icone || 'bi-flag')"></i>
                    </div>
                    <div class="card-missao-titulo-wrapper">
                      <h3 class="card-missao-titulo">
                        <span x-text="mod.titulo"></span>
                        <span class="card-missao-id" x-text="'#' + mod.id.substring(0, 8)"></span>
                      </h3>
                      <div class="card-missao-meta">
                        <span class="badge-status disponivel">Dispon√≠vel</span>
                        <span class="card-missao-tipo" x-text="mod.subtitulo || mod.tipo"></span>
                      </div>
                    </div>
                    <!-- Contador no canto superior direito -->
                    <div class="card-missao-timer-top">
                      <i class="bi bi-clock"></i>
                      <span class="contador-regressivo" 
                            :data-prazo-modelo="mod.prazo_padrao_horas || 168"
                            x-init="$nextTick(() => initCountdown($el, null, mod.prazo_padrao_horas || 168, null))"></span>
                    </div>
                  </div>
                    
                    <!-- Descri√ß√£o -->
                    <div class="card-missao-body">
                      <p class="card-missao-descricao" x-text="mod.descricao || 'Complete esta miss√£o para ganhar recompensas.'"></p>
                    </div>
                    
                    <!-- Recompensas -->
                    <div class="card-missao-recompensas-wrapper" x-show="(mod.recompensa_xp || 0) > 0 || (mod.recompensa_ouro || 0) > 0 || (mod.recompensas?.itens?.length || 0) > 0">
                      <div class="card-missao-recompensas">
                        <span class="card-missao-recompensa-item" x-show="(mod.recompensa_xp || mod.recompensas?.xp || 0) > 0">
                          <i class="bi bi-star-fill"></i>
                          <span x-text="(mod.recompensa_xp || mod.recompensas?.xp || 0) + ' XP'"></span>
                        </span>
                        <span class="card-missao-recompensa-item" x-show="(mod.recompensa_ouro || mod.recompensas?.ouro || 0) > 0">
                          <i class="bi bi-coin"></i>
                          <span x-text="(mod.recompensa_ouro || mod.recompensas?.ouro || 0) + ' ouro'"></span>
                        </span>
                        <template x-for="item in (mod.recompensas?.itens || [])" :key="item">
                          <span class="card-missao-recompensa-item">
                            <i class="bi bi-gift-fill"></i>
                            <span x-text="item"></span>
                          </span>
                        </template>
                      </div>
                    </div>
                    
                    <!-- A√ß√µes -->
                    <div class="card-missao-acoes">
                      <button type="button" class="btn btn-outline-secondary btn-sm" @click="abrirDetalhesMissao(mod, 'modelo')">
                        <i class="bi bi-eye me-1"></i> Ver detalhes
                      </button>
                      <button type="button" class="btn btn-primario btn-sm" @click="iniciarMissao(mod.id)">
                        <i class="bi bi-play-fill me-1"></i> Iniciar
                      </button>
                    </div>
                  </div>
                </template>
              </div>
            </div>
          </template>

          <!-- Cards de miss√µes (todas quando sem filtro, ou filtradas) -->
          <div>
            <p class="subtitulo-secao mb-3" x-show="filtroMissaoStatus !== null" x-text="(filtroMissaoStatus === 'ativa' ? 'Miss√µes em andamento' : filtroMissaoStatus === 'concluida' ? 'Miss√µes conclu√≠das' : 'Miss√µes n√£o conclu√≠das') + ' (' + totalMissoes + ')'"></p>
            <p class="subtitulo-secao mb-3" x-show="filtroMissaoStatus === null && missoesFiltradas.length > 0" x-text="'Suas miss√µes (' + totalMissoes + ')'"></p>
            <div class="cards-missoes-grid">
              <template x-for="m in (missoesFiltradas || [])" :key="m?.id || Math.random()">
                <div class="card-missao" :class="m.status === 'ativa' ? 'ativa' : m.status === 'concluida' ? 'concluida' : (m.status === 'expirada' || m.status === 'abandonada') ? (m.status === 'expirada' ? 'expirada' : 'abandonada') : 'disponivel'">
                  <!-- Header com √≠cone, t√≠tulo e status -->
                  <div class="card-missao-header">
                    <div class="card-missao-icone">
                      <i :class="'bi ' + (m.modelos_missao?.icone || 'bi-flag')"></i>
                    </div>
                    <div class="card-missao-titulo-wrapper">
                      <h3 class="card-missao-titulo">
                        <span x-text="m.modelos_missao?.titulo || 'Miss√£o'"></span>
                        <span class="card-missao-id" x-text="'#' + m.id.substring(0, 8)"></span>
                      </h3>
                      <div class="card-missao-meta">
                        <span class="badge-status" :class="m.status" x-text="m.status === 'ativa' ? 'Em Andamento' : m.status === 'concluida' ? 'Conclu√≠da' : m.status === 'expirada' ? 'Expirada' : m.status === 'abandonada' ? 'Abandonada' : 'Dispon√≠vel'"></span>
                        <span class="card-missao-tipo" x-text="m.modelos_missao?.subtitulo || m.modelos_missao?.tipo || ''"></span>
                      </div>
                    </div>
                    <!-- Contador no canto superior direito -->
                    <template x-if="m.status === 'ativa' && m.prazo_em">
                      <div class="card-missao-timer-top">
                        <i class="bi bi-clock"></i>
                        <span class="contador-regressivo" 
                              :data-prazo="m.prazo_em"
                              :data-missao-id="m.id"
                              x-init="$nextTick(() => initCountdown($el, m.prazo_em, null, m.id))"></span>
                      </div>
                    </template>
                    <template x-if="m.status === 'concluida' && m.concluida_em">
                      <div class="card-missao-timer-top">
                        <i class="bi bi-check-circle"></i>
                        <span class="card-missao-data-info" x-text="formatarDataConclusao(m.concluida_em)"></span>
                      </div>
                    </template>
                    <template x-if="m.status === 'expirada' && m.prazo_em">
                      <div class="card-missao-timer-top">
                        <i class="bi bi-exclamation-triangle"></i>
                        <span class="card-missao-data-info" x-text="formatarDataExpiracao(m.prazo_em)"></span>
                      </div>
                    </template>
                  </div>
                  
                  <!-- Descri√ß√£o -->
                  <div class="card-missao-body">
                    <p class="card-missao-descricao" x-text="m.modelos_missao?.descricao || 'Complete esta miss√£o para ganhar recompensas.'"></p>
                  </div>
                  
                  <!-- Checklist para miss√µes tipo tarefa -->
                  <div class="card-missao-checklist" x-show="m.modelos_missao?.tipo === 'tarefa' && m.checklist && m.checklist.length > 0">
                    <div class="card-missao-checklist-header">
                      <span class="fs-6 fw-600">Progresso: <span x-text="progressoChecklist(m) + '%'"></span></span>
                    </div>
                    <div class="card-missao-checklist-items">
                      <template x-for="item in m.checklist" :key="item.id">
                        <label class="checklist-item" :class="{ 'concluida': item.concluida }">
                          <input type="checkbox" 
                                 :checked="item.concluida" 
                                 @change="toggleChecklistItem(m.id, item.id)"
                                 :disabled="m.status !== 'ativa'">
                          <span class="checklist-item-text" x-text="item.texto"></span>
                          <span class="checklist-item-check" x-show="item.concluida">
                            <i class="bi bi-check-circle-fill"></i>
                          </span>
                        </label>
                      </template>
                    </div>
                  </div>
                  
                  <!-- Informa√ß√µes de miss√£o colaborativa -->
                  <div class="card-missao-colaborativa" x-show="m.tipo_colaborativa || m.modelos_missao?.tipo_colaborativa">
                    <div class="card-missao-colaborativa-header">
                      <i class="bi bi-people-fill me-2"></i>
                      <span class="fw-600">Miss√£o Colaborativa</span>
                    </div>
                    <div class="card-missao-colaborativa-progresso">
                      <div class="progress mb-2" style="height: 8px;">
                        <div class="progress-bar" 
                             :style="'width: ' + ((m.progresso_total || 0) / (m.modelos_missao?.meta_total || 100) * 100) + '%'"></div>
                      </div>
                      <div class="d-flex justify-content-between fs-menor">
                        <span>Progresso: <span x-text="m.progresso_total || 0"></span>/<span x-text="m.modelos_missao?.meta_total || 100"></span></span>
                        <span x-text="(m.participantes || []).length + ' participantes'"></span>
                      </div>
                    </div>
                    <div class="card-missao-colaborativa-participantes" x-show="m.participantes && m.participantes.length > 0">
                      <template x-for="(participante, index) in (m.participantes || []).slice(0, 3)" :key="participante.usuario_id">
                        <span class="badge bg-secondary me-1" x-text="participante.nome"></span>
                      </template>
                      <span class="badge bg-secondary" x-show="(m.participantes || []).length > 3" x-text="'+' + ((m.participantes || []).length - 3)"></span>
                    </div>
                  </div>
                  
                  <!-- Recompensas -->
                  <div class="card-missao-recompensas-wrapper" x-show="(m.modelos_missao?.recompensa_xp || m.modelos_missao?.recompensas?.xp || 0) > 0 || (m.modelos_missao?.recompensa_ouro || m.modelos_missao?.recompensas?.ouro || 0) > 0 || (m.modelos_missao?.recompensas?.itens?.length || 0) > 0">
                    <div class="card-missao-recompensas">
                      <span class="card-missao-recompensa-item" x-show="(m.modelos_missao?.recompensa_xp || m.modelos_missao?.recompensas?.xp || 0) > 0">
                        <i class="bi bi-star-fill"></i>
                        <span x-text="(m.modelos_missao?.recompensa_xp || m.modelos_missao?.recompensas?.xp || 0) + ' XP'"></span>
                      </span>
                      <span class="card-missao-recompensa-item" x-show="(m.modelos_missao?.recompensa_ouro || m.modelos_missao?.recompensas?.ouro || 0) > 0">
                        <i class="bi bi-coin"></i>
                        <span x-text="(m.modelos_missao?.recompensa_ouro || m.modelos_missao?.recompensas?.ouro || 0) + ' ouro'"></span>
                      </span>
                      <template x-for="item in (m.modelos_missao?.recompensas?.itens || [])" :key="item">
                        <span class="card-missao-recompensa-item">
                          <i class="bi bi-gift-fill"></i>
                          <span x-text="item"></span>
                        </span>
                      </template>
                    </div>
                  </div>
                  
                  <!-- A√ß√µes -->
                  <div class="card-missao-acoes">
                    <button type="button" class="btn btn-outline-secondary btn-sm" @click="abrirDetalhesMissao(m, 'missao')">
                      <i class="bi bi-eye me-1"></i> Ver detalhes
                    </button>
                    <template x-if="m.status === 'ativa'">
                      <button type="button" class="btn btn-primario btn-sm" @click="concluirMissao(m)">
                        <i class="bi bi-check-circle me-1"></i> Concluir
                      </button>
                      <button type="button" class="btn btn-outline-danger btn-sm" @click="desistirMissao(m)">
                        <i class="bi bi-x-circle me-1"></i> Desistir
                      </button>
                    </template>
                  </div>
              </template>
            </div>
            <p x-show="missoesFiltradas.length === 0 && filtroMissaoStatus !== null" class="texto-secundario text-center py-3">Nenhuma miss√£o encontrada.</p>
          </div>

          <!-- Pagina√ß√£o -->
          <div class="paginacao-missoes" x-show="totalMissoes > limiteMissoes">
            <button type="button" class="paginacao-btn" @click="paginaMissoes = Math.max(1, paginaMissoes - 1); atualizarFiltrosMissoes()" :disabled="paginaMissoes === 1">
              <i class="bi bi-chevron-left"></i>
            </button>
            <template x-for="p in paginasMissoes" :key="p">
              <button type="button" class="paginacao-btn" :class="{ ativo: p === paginaMissoes }" @click="if (p !== '...') { paginaMissoes = p; atualizarFiltrosMissoes(); }" x-text="p === '...' ? '...' : p"></button>
            </template>
            <button type="button" class="paginacao-btn" @click="paginaMissoes = Math.min(totalPaginasMissoes, paginaMissoes + 1); atualizarFiltrosMissoes()" :disabled="paginaMissoes === totalPaginasMissoes">
              <i class="bi bi-chevron-right"></i>
            </button>
            <span class="paginacao-info" x-text="paginaMissoes + '/' + totalPaginasMissoes"></span>
            <select class="form-select form-select-sm" style="width: auto; min-width: 70px;" @change="limiteMissoes = parseInt($event.target.value); paginaMissoes = 1; atualizarFiltrosMissoes()">
              <option value="10" :selected="limiteMissoes === 10">10</option>
              <option value="20" :selected="limiteMissoes === 20">20</option>
              <option value="50" :selected="limiteMissoes === 50">50</option>
              <option value="999" :selected="limiteMissoes === 999">Todos</option>
            </select>
          </div>
        </div>

        <!-- Modal de detalhes da miss√£o -->
        <div x-show="modalDetalhesMissao.aberto" class="modal-detalhes-missao" @click.self="fecharDetalhesMissao()" x-transition>
          <div class="card-tema p-3">
            <div class="d-flex justify-content-between align-items-start mb-3">
              <h3 class="fw-600 mb-0" x-text="modalDetalhesMissao.missao?.modelos_missao?.titulo || modalDetalhesMissao.missao?.titulo || 'Detalhes da Miss√£o'"></h3>
              <button type="button" class="btn btn-link btn-sm p-0" @click="fecharDetalhesMissao()"><i class="bi bi-x-lg"></i></button>
            </div>
            <div class="mb-3">
              <span class="badge-status" :class="modalDetalhesMissao.missao?.status || 'disponivel'" x-text="modalDetalhesMissao.missao?.status === 'ativa' ? 'Em Andamento' : modalDetalhesMissao.missao?.status === 'concluida' ? 'Conclu√≠da' : modalDetalhesMissao.missao?.status === 'expirada' ? 'Expirada' : modalDetalhesMissao.missao?.status === 'abandonada' ? 'Abandonada' : 'Dispon√≠vel'"></span>
            </div>
            <p class="texto-secundario mb-3" x-text="modalDetalhesMissao.missao?.modelos_missao?.descricao_completa || modalDetalhesMissao.missao?.modelos_missao?.descricao || modalDetalhesMissao.missao?.descricao || 'Descri√ß√£o completa da miss√£o.'"></p>
            
            <!-- Checklist no modal -->
            <div class="mb-3" x-show="modalDetalhesMissao.missao && modalDetalhesMissao.missao?.modelos_missao?.tipo === 'tarefa' && modalDetalhesMissao.missao?.checklist && modalDetalhesMissao.missao?.checklist.length > 0">
              <h4 class="fs-6 fw-600 mb-2">Checklist <span class="fs-menor texto-secundario">(<span x-text="modalDetalhesMissao.missao ? progressoChecklist(modalDetalhesMissao.missao) : 0"></span>% conclu√≠do)</span></h4>
              <div class="card-missao-checklist-items">
                <template x-for="item in (modalDetalhesMissao.missao?.checklist || [])" :key="item.id">
                  <label class="checklist-item" :class="{ 'concluida': item.concluida }">
                    <input type="checkbox" 
                           :checked="item.concluida" 
                           @change="toggleChecklistItem(modalDetalhesMissao.missao.id, item.id)"
                           :disabled="modalDetalhesMissao.missao.status !== 'ativa'">
                    <span class="checklist-item-text" x-text="item.texto"></span>
                    <span class="checklist-item-check" x-show="item.concluida">
                      <i class="bi bi-check-circle-fill"></i>
                    </span>
                  </label>
                </template>
              </div>
            </div>
            
            <!-- Informa√ß√µes colaborativas no modal -->
            <div class="mb-3" x-show="modalDetalhesMissao.missao?.tipo_colaborativa || modalDetalhesMissao.missao?.modelos_missao?.tipo_colaborativa">
              <h4 class="fs-6 fw-600 mb-2">
                <i class="bi bi-people-fill me-2"></i>Miss√£o Colaborativa
              </h4>
              <div class="card-missao-colaborativa-progresso">
                <div class="progress mb-2" style="height: 12px;">
                  <div class="progress-bar" 
                       :style="'width: ' + ((modalDetalhesMissao.missao?.progresso_total || 0) / (modalDetalhesMissao.missao?.modelos_missao?.meta_total || 100) * 100) + '%'"></div>
                </div>
                <div class="d-flex justify-content-between fs-menor mb-2">
                  <span>Progresso: <span x-text="modalDetalhesMissao.missao?.progresso_total || 0"></span>/<span x-text="modalDetalhesMissao.missao?.modelos_missao?.meta_total || 100"></span></span>
                  <span x-text="(modalDetalhesMissao.missao?.participantes || []).length + ' participantes'"></span>
                </div>
                <div class="card-missao-colaborativa-participantes" x-show="modalDetalhesMissao.missao && modalDetalhesMissao.missao?.participantes && modalDetalhesMissao.missao.participantes.length > 0">
                  <strong class="fs-menor me-2">Participantes:</strong>
                  <template x-for="participante in (modalDetalhesMissao.missao?.participantes || [])" :key="participante?.usuario_id || Math.random()">
                    <span class="badge bg-secondary me-1" x-text="participante.nome + ' (' + participante.progresso + '%)'"></span>
                  </template>
                </div>
              </div>
            </div>
            
            <div class="mb-3">
              <h4 class="fs-6 fw-600 mb-2">Recompensas</h4>
              <div class="card-missao-recompensas">
                <span class="card-missao-recompensa-item" x-show="(modalDetalhesMissao.missao?.modelos_missao?.recompensa_xp || modalDetalhesMissao.missao?.modelos_missao?.recompensas?.xp || modalDetalhesMissao.missao?.recompensa_xp || 0) > 0">
                  <i class="bi bi-star-fill"></i> <span x-text="(modalDetalhesMissao.missao?.modelos_missao?.recompensa_xp || modalDetalhesMissao.missao?.modelos_missao?.recompensas?.xp || modalDetalhesMissao.missao?.recompensa_xp || 0) + ' XP'"></span>
                </span>
                <span class="card-missao-recompensa-item" x-show="(modalDetalhesMissao.missao?.modelos_missao?.recompensa_ouro || modalDetalhesMissao.missao?.modelos_missao?.recompensas?.ouro || modalDetalhesMissao.missao?.recompensa_ouro || 0) > 0">
                  <i class="bi bi-coin"></i> <span x-text="(modalDetalhesMissao.missao?.modelos_missao?.recompensa_ouro || modalDetalhesMissao.missao?.modelos_missao?.recompensas?.ouro || modalDetalhesMissao.missao?.recompensa_ouro || 0) + ' ouro'"></span>
                </span>
                <!-- Itens de recompensa - verificar tanto em modelos_missao (para miss√µes) quanto diretamente na missao (para modelos) -->
                <template x-for="(item, index) in getItensRecompensaModal()" :key="'item-' + index">
                  <span class="card-missao-recompensa-item">
                    <i class="bi bi-gift-fill"></i>
                    <span x-text="item"></span>
                  </span>
                </template>
              </div>
            </div>
            <div class="mb-3" x-show="modalDetalhesMissao.missao?.modelos_missao?.consequencias || modalDetalhesMissao.missao?.consequencias">
              <h4 class="fs-6 fw-600 mb-2">Consequ√™ncias</h4>
              <p class="texto-secundario fs-menor" x-text="(modalDetalhesMissao.missao?.modelos_missao?.consequencias?.mensagem || modalDetalhesMissao.missao?.consequencias?.mensagem || 'N√£o completar esta miss√£o pode resultar em pontos negativos.')"></p>
            </div>
            <div class="d-flex gap-2 justify-content-end">
              <button type="button" class="btn btn-outline-secondary btn-sm" @click="fecharDetalhesMissao()">Fechar</button>
              <button type="button" class="btn btn-primario btn-sm" @click="iniciarMissao(modalDetalhesMissao.missao?.id || modalDetalhesMissao.missao?.modelo_id)" x-show="!modalDetalhesMissao.missao?.status || modalDetalhesMissao.missao?.status === 'disponivel'">Iniciar</button>
              <button type="button" class="btn btn-primario btn-sm" @click="concluirMissao(modalDetalhesMissao.missao)" x-show="modalDetalhesMissao.missao?.status === 'ativa'">Concluir</button>
            </div>
          </div>
        </div>

        <!-- Invent√°rio -->
        <div x-show="pagina === 'inventario'" style="display: none;" class="inventario-rpg">
          <h2 class="titulo-pagina mb-1">üéí Invent√°rio</h2>
          
          <!-- Tabs de Navega√ß√£o -->
          <div class="inventario-tabs mb-4">
            <button class="tab-btn" :class="{ ativo: viewInventario === 'equipamentos' }" @click="viewInventario = 'equipamentos'">
              <i class="bi bi-shield"></i> Equipamentos
            </button>
            <button class="tab-btn" :class="{ ativo: viewInventario === 'consumiveis' }" @click="viewInventario = 'consumiveis'">
              <i class="bi bi-flask"></i> Consum√≠veis
            </button>
            <button class="tab-btn" :class="{ ativo: viewInventario === 'fruto' }" @click="viewInventario = 'fruto'; setTimeout(() => renderizarFrutosSVG(), 100)">
              <i class="bi bi-tree"></i> Fruto do Esp√≠rito
            </button>
            <button class="tab-btn" :class="{ ativo: viewInventario === 'obras' }" @click="viewInventario = 'obras'; setTimeout(() => renderizarObrasSVG(), 100)">
              <i class="bi bi-exclamation-triangle"></i> Obras da Carne
            </button>
          </div>

          <!-- Aba: Equipamentos -->
          <div x-show="viewInventario === 'equipamentos'">
            <!-- Armadura de Deus (Ef 6.10-18) -->
            <div class="inventario-secao mb-4">
              <h3 class="secao-titulo">
                <i class="bi bi-shield-fill"></i>
                Armadura de Deus
                <span class="ref-biblica" :title="REFS_BIBLICAS.ARMADURA_DEUS">Ef√©sios 6.10-18</span>
              </h3>
              <div class="armadura-grid">
                <template x-for="slot in ARMADURA_DEUS_SLOTS" :key="slot.id">
                  <div class="slot-equipamento" :class="{ 'slot-vazio': !getItemEquipadoSlot(slot.id) }" :title="slot.ref + ' ‚Äî ' + REFS_BIBLICAS.ARMADURA_DEUS">
                    <div class="slot-icone">
                      <i :class="'bi bi-' + (getItemEquipadoSlot(slot.id)?.icone || 'dash-circle')"></i>
                    </div>
                    <div class="slot-info">
                      <span class="slot-nome" x-text="getItemEquipadoSlot(slot.id)?.nome || slot.nome"></span>
                      <span class="slot-ref" x-text="slot.ref"></span>
                    </div>
                  </div>
                </template>
              </div>
            </div>

            <!-- Itens Permanentes Equipados -->
            <div class="inventario-secao mb-4" x-show="inventario.filter(l => l.equipado && l.itens?.tipo === 'permanente').length > 0">
              <h3 class="secao-titulo">
                <i class="bi bi-star-fill"></i>
                Itens Permanentes
              </h3>
              <div class="itens-grid">
                <template x-for="linha in inventario.filter(l => l.equipado && l.itens?.tipo === 'permanente')" :key="linha.id">
                  <div class="item-inventario" :class="'raridade-' + (linha.itens?.raridade || 'comum')">
                    <div class="item-inventario-icone">
                      <i :class="'bi ' + (linha.itens?.icone || 'bi-box')"></i>
                    </div>
                    <div class="item-inventario-info">
                      <span class="item-inventario-nome" x-text="linha.itens?.nome"></span>
                      <button class="btn-desequipar" @click="toggleEquipar(linha)">Desequipar</button>
                    </div>
                  </div>
                </template>
              </div>
            </div>

            <!-- Efeitos Ativos (Consum√≠veis em Uso) -->
            <div class="inventario-secao mb-4" x-show="efeitosAtivos.length > 0">
              <h3 class="secao-titulo">
                <i class="bi bi-lightning-charge-fill"></i>
                Efeitos Ativos
              </h3>
              <div class="efeitos-ativos-grid">
                <template x-for="e in efeitosAtivos" :key="e.id">
                  <div class="efeito-ativo-card">
                    <div class="efeito-ativo-icone">
                      <i :class="'bi ' + (e.itens?.icone || 'bi-flask')"></i>
                    </div>
                    <div class="efeito-ativo-info">
                      <span class="efeito-ativo-nome" x-text="e.itens?.nome || 'Efeito'"></span>
                      <span class="efeito-ativo-tempo" x-text="tempoRestante(e.termina_em)"></span>
                    </div>
                  </div>
                </template>
              </div>
            </div>
          </div>

          <!-- Aba: Consum√≠veis -->
          <div x-show="viewInventario === 'consumiveis'">
            <div class="inventario-secao">
              <h3 class="secao-titulo">
                <i class="bi bi-flask"></i>
                Consum√≠veis na Bolsa
              </h3>
              <template x-if="inventario.filter(l => l.itens?.tipo === 'consumivel' && l.quantidade > 0).length === 0">
                <p class="texto-secundario text-center py-4">Nenhum consum√≠vel na bolsa. Visite a loja!</p>
              </template>
              <div class="itens-grid">
                <template x-for="linha in inventario.filter(l => l.itens?.tipo === 'consumivel' && l.quantidade > 0)" :key="linha.id">
                  <div class="item-inventario consumivel" :class="'raridade-' + (linha.itens?.raridade || 'comum')">
                    <div class="item-inventario-icone">
                      <i :class="'bi ' + (linha.itens?.icone || 'bi-flask')"></i>
                      <span class="item-quantidade" x-text="'x' + linha.quantidade"></span>
                    </div>
                    <div class="item-inventario-info">
                      <span class="item-inventario-nome" x-text="linha.itens?.nome"></span>
                      <span class="item-inventario-desc" x-text="linha.itens?.descricao"></span>
                      <button class="btn-usar" @click="usarItemConsumivel(linha.item_id)">Usar</button>
                    </div>
                  </div>
                </template>
              </div>
            </div>
          </div>

          <!-- Aba: Fruto do Esp√≠rito (√Årvore) -->
          <div x-show="viewInventario === 'fruto'">
            <div class="inventario-secao">
              <h3 class="secao-titulo">
                <i class="bi bi-tree-fill"></i>
                Fruto do Esp√≠rito
                <span class="ref-biblica" :title="REFS_BIBLICAS.FRUTO_ESPIRITO">G√°latas 5.22-23</span>
              </h3>
              <div class="fruto-arvore-container">
                <svg class="fruto-arvore-svg" viewBox="0 0 1024 1024" preserveAspectRatio="xMidYMid meet" version="1.1" xmlns="http://www.w3.org/2000/svg">
                  <defs>
                    <style type="text/css">
                      .arvore-folhas-verde{fill:#5CB087;}
                      .arvore-folhas-verde-escuro{fill:#00757F;}
                      .arvore-tronco-svg{fill:#b67b68;}
                    </style>
                  </defs>
                  
                  <!-- √Årvore original fornecida -->
                  <g id="arvore-original">
                    <!-- Folhas verdes escuras -->
                    <path class="arvore-folhas-verde-escuro" d="M637.69 789c46.82-14.7 73.85 24.35 135.43-22.21s71.34-128.41 63.08-153.2c-16.52-64.58-60.08-84.11-63-125.54-3-41.93 41.23-57.69 20.65-120.95-26.45-81.3-65.48-61.71-71.49-70.72s15.32-27-19.83-97.32c-24.78-49.56-41.3-36-57.82-54.07s-4.5-27.36-21.78-39c-25.53-17.27-18.77 3.75-60.08-9C527.56 86 505 54.15 469.74 66.91c-82.17 29.72-55.73 87.7-72.25 105.72s-43.39 14.43-58.41 31-30 61.58-30 76.6 3 52.57 0 61.58-26.13-2.1-44.16 15.92-5.42 29.74-21.92 53.77-57.4 30.89-57.73 92.5c-0.4 75.85 33.41 81.6 26.69 111.23-7.56 33.32-35.1 84-6.56 136.59S282 840.4 340.57 838.9s39-19.53 75.1-19.53 73.59 24 139.68 10.51 53.33-31.75 82.34-40.88z"/>
                    
                    <!-- Folhas verdes claras (ma√ß√£s) -->
                    <path class="arvore-folhas-verde" d="M646 604.6c5.32 0 16.52 1.5 18 20.53a39.16 39.16 0 0 1-10.26 30.16s-9.26-10.14-11.26-20.15c-3.03-15.71 4.52-23.78 3.52-30.54zM754 688.08c-2.75-4.55-7.27-14.91 8.23-26a39.16 39.16 0 0 1 31.12-6.84s-3.88 13.17-11.41 20.07c-11.87 10.69-22.67 8.41-27.94 12.77zM398.35 593.07c5 1.94 14.84 7.42 9.3 25.68a39.16 39.16 0 0 1-20.55 24.35s-4.93-12.82-3.15-22.87c2.93-15.72 12.87-20.5 14.4-27.16zM331.52 535.27c5.25-0.87 16.54-1.22 21.13 17.31a39.16 39.16 0 0 1-5.2 31.43s-10.79-8.49-14.41-18c-5.52-15.01 0.57-24.23-1.52-30.74zM248.41 711.5c5.25-0.87 16.54-1.22 21.13 17.31a39.16 39.16 0 0 1-5.2 31.43s-10.79-8.49-14.41-18c-5.52-15.05 0.57-24.24-1.52-30.74zM465.43 430.07c5.29 0.56 16.27 3.23 15.76 22.31a39.16 39.16 0 0 1-13.38 28.92s-8.14-11.06-9.08-21.22c-1.33-15.95 6.99-23.18 6.7-30.01zM380.65 327.94c5.29 0.56 16.27 3.23 15.76 22.31A39.16 39.16 0 0 1 383 379.16s-8.14-11.06-9.08-21.22c-1.31-15.94 7.01-23.17 6.73-30zM481.56 223.27c5.32 0.1 16.49 1.82 17.63 20.87a39.16 39.16 0 0 1-10.84 30s-9.07-10.31-10.88-20.36c-2.7-15.78 4.96-23.78 4.09-30.51zM538 278.32c5.28-0.67 16.58-0.59 20.46 18.1a39.16 39.16 0 0 1-6.39 31.21s-10.46-8.89-13.71-18.58c-4.93-15.2 1.5-24.15-0.36-30.73zM614.89 179.31c5.29 0.55 16.28 3.2 15.81 22.27a39.16 39.16 0 0 1-13.32 28.95s-8.17-11-9.13-21.2c-1.36-15.94 6.94-23.2 6.64-30.02zM665 230.53c5.29 0.55 16.28 3.2 15.81 22.27a39.16 39.16 0 0 1-13.32 28.95s-8.17-11-9.13-21.2c-1.36-15.94 6.89-23.2 6.64-30.02zM698.68 321.54c5.31-0.36 16.58 0.39 19.35 19.28a39.16 39.16 0 0 1-8.22 30.78s-9.92-9.5-12.59-19.35c-4.04-15.48 2.91-24.04 1.46-30.71zM637.09 346.12c4.72-2.46 15.35-6.3 25.47 9.88a39.16 39.16 0 0 1 4.83 31.49s-12.9-4.71-19.3-12.67c-9.92-12.54-6.99-23.16-11-28.7zM679.4 451.67c4.5 0.29 13.89 2.17 14.13 18.34a33.19 33.19 0 0 1-10.32 25s-7.28-9.08-8.43-17.65c-1.69-13.5 5.1-19.92 4.62-25.69zM736.92 372.89c4.17-1.7 13.44-4.11 20.71 10.34a33.19 33.19 0 0 1 1.6 27s-10.51-5-15.29-12.2c-7.38-11.42-4.07-20.16-7.02-25.14zM491.11 328.54c4.17-1.7 13.44-4.11 20.71 10.34a33.19 33.19 0 0 1 1.6 27s-10.51-5-15.29-12.2c-7.38-11.42-4.07-20.16-7.02-25.14zM259.52 495.22c-4.29-1.39-12.92-5.53-9.16-21.26a33.19 33.19 0 0 1 16.16-21.63s4.81 10.59 3.81 19.19c-1.68 13.48-9.85 17.99-10.81 23.7zM244.43 584c-3.22-2.06-9.43-7.3-3-19.41a28.15 28.15 0 0 1 17.89-14.3s1.69 9.73-1 16.57c-4.21 10.69-11.88 12.67-13.89 17.14zM296.62 602.79c-3.22-2.06-9.43-7.3-3-19.41a28.15 28.15 0 0 1 17.89-14.3s1.69 9.73-1 16.57c-4.21 10.67-11.88 12.66-13.89 17.14zM332 342.07c-2.4-3-6.61-9.93 3.36-19.35a28.15 28.15 0 0 1 21.52-7.86s-1.5 9.76-6.2 15.39c-7.46 8.75-15.36 8.22-18.68 11.82zM365.78 269.79c-2.4-3-6.61-9.93 3.36-19.35a28.15 28.15 0 0 1 21.52-7.86s-1.5 9.76-6.2 15.39c-7.46 8.77-15.35 8.21-18.68 11.82zM444.16 258.72c-3.79 0.48-11.92 0.42-14.71-13a28.15 28.15 0 0 1 4.55-22.45s7.52 6.39 9.86 13.35c3.6 10.93-1.02 17.38 0.3 22.1zM448.46 318c-3.54 1.45-11.39 3.52-17.59-8.72a28.15 28.15 0 0 1-1.42-22.86s8.93 4.21 13 10.32c6.28 9.65 3.5 17.07 6.01 21.26zM491.38 196.75c-3.77 0.63-11.89 0.88-15.2-12.44a28.15 28.15 0 0 1 3.73-22.6s7.76 6.1 10.36 13c3.98 10.76-0.39 17.36 1.11 22.04zM575.77 176.12c2.87 2.52 8.21 8.65 0 19.64a28.15 28.15 0 0 1-19.86 11.42s-0.19-9.87 3.48-16.23c5.83-9.95 13.72-10.71 16.38-14.83zM620.08 293.21c-3.81 0.37-11.93 0.08-14.33-13.42a28.15 28.15 0 0 1 5.23-22.3s7.34 6.6 9.47 13.63c3.25 11.02-1.56 17.32-0.37 22.09zM603.76 397c-3.81 0.37-11.93 0.08-14.33-13.42a28.15 28.15 0 0 1 5.23-22.3s7.34 6.6 9.47 13.63c3.25 11.01-1.56 17.31-0.37 22.09z"/>
                    
                    <!-- Tronco -->
                    <path class="arvore-tronco-svg" d="M515.53 671.23s24.08-63.58 20.94-102.15-10.33-139-10.33-139h27.21l13 129.42 27-129.42 20 12.32s-22 86.09-31.06 150.68-17.77 129.68-17.9 146.7c0 0 29.24-14.12 57.11-28.59s59.93-56.09 71.94-56.81 20 18.31 20 22.31-57.79 53.07-76.46 63.08-41.7 14-58.72 36S546.48 839.9 547.91 892s4.43 68.09 4.43 68.09H469.9s0.34-111.14-4.67-157.2-5-83.36-12-114.77-39.48-106.62-56.79-128.59S309 475.82 296 430.07c-10-19.89 6-27.08 12-19.89s53.07 102.3 93.12 118.33c-10.49-41.05-56.07-101.13-52.07-109.14s25.91-13 34.48-5 1.56 22.72 29.6 59.42 40.34 47.93 63.73 93.38 38.67 104.06 38.67 104.06z"/>
                  </g>
                  
                  <!-- Frutos do Esp√≠rito nas folhas - Renderizados via JavaScript -->
                  <g id="frutos-container"></g>
                </svg>
                
                <!-- Labels HTML sobrepostos -->
                <div class="fruto-labels-overlay">
                  <template x-for="(fruto, index) in FRUTO_DO_ESPIRITO" :key="index">
                    <div class="fruto-label-overlay" 
                         :style="getPosicaoLabelFruto(index)"
                         :class="{ 'desbloqueado': isFrutoDesbloqueado(index) }"
                         :title="fruto + (isFrutoDesbloqueado(index) ? ' (Desbloqueado)' : ' (Bloqueado)')"
                         x-text="fruto"></div>
                  </template>
                </div>
              </div>
            </div>
          </div>

          <!-- Aba: Obras da Carne -->
          <div x-show="viewInventario === 'obras'">
            <div class="inventario-secao">
              <h3 class="secao-titulo">
                <i class="bi bi-exclamation-triangle-fill"></i>
                Obras da Carne
                <span class="ref-biblica" :title="REFS_BIBLICAS.OBRAS_CARNE">G√°latas 5.19-21</span>
              </h3>
              <div class="obras-container">
                <svg class="obras-svg" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet" version="1.1" xmlns="http://www.w3.org/2000/svg">
                  <defs>
                    <style type="text/css">
                      .obras-coracao-grande{fill:#ff69b4;stroke:#dc143c;stroke-width:6;opacity:0.7;}
                      .obras-coracao-bg{fill:#ff69b4;stroke:#dc143c;stroke-width:2;}
                      .obras-coracao-bg.ativa{fill:#ff1493;stroke:#8b0000;filter:drop-shadow(0 0 8px rgba(220, 20, 60, 0.8));}
                    </style>
                    <linearGradient id="obrasGradiente" x1="0%" y1="0%" x2="100%" y2="100%">
                      <stop offset="0%" style="stop-color:#8b0000;stop-opacity:1" />
                      <stop offset="100%" style="stop-color:#ff4500;stop-opacity:1" />
                    </linearGradient>
                  </defs>
                  
                  <!-- Fundo com gradiente -->
                  <rect width="512" height="512" fill="url(#obrasGradiente)" opacity="0.3"/>
                  
                  <!-- Cora√ß√£o grande centralizado (fundo) -->
                  <g class="coracao-grande-pulsante">
                    <path class="obras-coracao-grande" d="M393.133,102.658c-6.362,3.505-7.21,14.192-1.897,23.865c5.314,9.683,14.803,14.698,21.165,11.194 c6.37-3.486,7.226-14.174,1.896-23.865C408.992,104.17,399.511,99.154,393.133,102.658z"/>
                    <path class="obras-coracao-grande" d="M165.592,329.096c-4.7-10.338-7.602-21.793-8.318-35.81c-0.148-2.84-0.201-5.812-0.157-8.878 c0.044-3.068-2.412-5.585-5.479-5.637c-3.058-0.026-5.584,2.421-5.627,5.496c-0.035,3.295,0.008,6.485,0.174,9.595 c0.768,15.232,4.002,28.208,9.306,39.839c5.313,11.613,12.644,21.828,21.435,31.746c5.13,5.785,7.367,12.549,7.725,19.321 c0.367,6.912-1.398,13.772-3.993,18.621c-1.433,2.7-0.411,6.056,2.299,7.498c2.7,1.442,6.073,0.42,7.506-2.289 c3.575-6.72,5.724-15.31,5.278-24.398c-0.437-8.843-3.513-18.263-10.503-26.128C176.909,348.688,170.311,339.408,165.592,329.096z"/>
                    <path class="obras-coracao-grande" d="M250.198,367.581c7.76-0.402,13.868-3.137,17.993-5.767c4.159-2.613,6.396-5.121,6.649-5.409 c2.028-2.307,1.81-5.811-0.506-7.838c-2.281-2.01-5.776-1.8-7.795,0.472h-0.018l-0.061,0.078c-0.35,0.376-2.132,2.158-5.024,3.828 c-2.919,1.704-6.878,3.285-11.797,3.539c-3.277,0.156-6.99-0.245-11.264-1.705c-7.463-2.542-13.982-7.182-19.582-12.871 c-8.389-8.546-14.593-19.426-18.596-28.147c-2.01-4.36-3.469-8.188-4.421-10.879c-0.48-1.346-0.83-2.412-1.049-3.137 c-0.114-0.358-0.201-0.629-0.244-0.804l-0.062-0.192l-0.017-0.052c-0.83-2.945-3.898-4.658-6.852-3.819 c-2.953,0.812-4.658,3.889-3.836,6.842v-0.008c0.088,0.262,3.583,12.67,11.544,26.792c3.994,7.061,9.114,14.558,15.624,21.191 c6.475,6.598,14.392,12.348,23.9,15.59C240.341,367.196,245.549,367.808,250.198,367.581z"/>
                    <path class="obras-coracao-grande" d="M238.017,420.859c-2.604-2.22-4.938-4.01-7.236-5.339c-1.171-0.664-2.325-1.206-3.565-1.625 c-1.224-0.402-2.587-0.664-4.072-0.594c-1.04,0.052-2.132,0.288-3.155,0.752c-1.826,0.786-3.233,2.219-4.106,3.67 c-1.32,2.22-1.8,4.474-2.106,7.008c-0.279,2.543-0.297,5.409-0.123,8.739c0.149,3.058,2.762,5.409,5.829,5.261 c3.058-0.166,5.418-2.762,5.261-5.829c-0.114-2.246-0.123-4.151-0.035-5.646c0.052-0.935,0.148-1.651,0.253-2.263 c0.323,0.183,0.691,0.385,1.092,0.647c2.193,1.416,5.365,4.054,9.201,7.742c3.862,3.678,8.45,8.424,13.772,14.104 c2.096,2.219,5.618,2.351,7.846,0.244c2.228-2.097,2.36-5.61,0.253-7.847C249.455,431.694,243.199,425.35,238.017,420.859z"/>
                    <path class="obras-coracao-grande" d="M286.637,378.346c-1.94,2.517-4.019,3.836-6.475,4.754c-2.447,0.9-5.296,1.267-8.249,1.424 c-2.062,0.096-4.168,0.096-6.256,0.21c-1.285,0.061-2.561,0.165-3.889,0.402c-0.979,0.192-2.019,0.464-3.085,0.926 c-0.804,0.341-1.635,0.813-2.412,1.46c-1.188,0.944-2.21,2.325-2.761,3.836c-0.567,1.512-0.725,3.058-0.646,4.527 c0.13,2.368,0.83,4.491,1.738,6.493c1.661,3.495,4.081,6.693,6.834,9.804c4.107,4.649,8.965,9.018,13.125,12.513 c2.08,1.766,3.959,3.286,5.461,4.5c0.76,0.603,1.416,1.128,1.923,1.564c0.516,0.411,0.9,0.743,1.057,0.883 c2.272,2.036,5.776,1.861,7.839-0.41c2.054-2.29,1.87-5.785-0.402-7.848c-0.647-0.576-1.406-1.188-2.438-2.01 c-1.756-1.432-4.177-3.372-6.842-5.644c-3.994-3.382-8.512-7.506-11.911-11.447c-1.686-1.975-3.102-3.88-4.02-5.506 c-0.638-1.135-0.987-2.088-1.162-2.752c0.55-0.096,1.267-0.157,2.158-0.201c1.678-0.087,3.845-0.096,6.258-0.226 c3.433-0.176,7.419-0.577,11.499-2.072c4.081-1.468,8.231-4.159,11.482-8.45c1.852-2.438,1.39-5.925-1.048-7.769 C291.977,375.445,288.489,375.909,286.637,378.346z"/>
                    <path class="obras-coracao-grande" d="M447.45,106.451c-4.343-10.914-11.168-20.911-19.819-28.714c-4.334-3.889-9.175-7.245-14.55-9.691 c-5.33-2.447-11.29-4.002-17.59-4.019h-0.192c-6.658,0-13.492,1.843-19.644,5.61c-8.983,5.488-17.599,11.308-25.874,17.407 c0.988-2.045,2.176-4.334,3.574-6.833c2.482-4.527,5.471-9.788,8.057-15.93l0.07-0.123l0.053-0.13 c1.145-2.762,1.713-5.68,1.731-8.669c-0.009-4.308-1.197-8.118-2.779-11.29c-2.735-5.418-6.658-9.542-10.826-13.072 c-6.31-5.278-13.772-9.542-21.392-12.732c-3.818-1.59-7.698-2.91-11.569-3.854l-0.114-0.035l0.105,0.018 c-0.053-0.009-0.097-0.009-0.148-0.026c-3.81-0.927-7.672-1.529-11.701-1.538c-3.076,0.009-6.493,0.367-10.066,1.687 c-1.8,0.681-3.688,1.643-5.479,3.006c-1.818,1.381-3.496,3.137-4.824,5.243c-0.979,1.573-1.748,3.058-2.508,4.562 c-1.319,2.63-2.692,5.523-4.185,8.407l-0.053,0.105l0.044-0.096c-2.141,4.195-4.78,8.468-6.869,10.792 c-3.425,3.775-6.842-24.013-8.642-27.185c-1.931-3.443-4.571-6.318-7.602-8.834c-5.165-4.265-11.036-6.572-16.778-7.996 c-20.256-4.955-49.757-3.906-62.576,15.292c-0.004,0-0.004,0.009-0.004,0.009l-0.013,0.018l0.008-0.009 c-2.595,4.098-4.15,8.301-5.199,12.216c-1.032,3.906-1.591,7.655-1.599,11.317c0,2.569,0.183,4.946,0.314,7.532 c0.315,5.628,0.664,11.142-0.498,16.568c-5.995-8.03-9.866-17.442-15.415-25.761c-1.538-2.342-3.434-4.08-5.33-5.409 c-2.78-1.913-5.706-3.04-8.546-3.748c-2.848-0.716-5.793-1.023-8.817-1.032c-5.226,0.009-10.836,0.962-16.603,2.972 c-5.767,2.019-11.736,5.12-17.529,9.464c-6.685,5.024-11.701,10.224-15.196,15.79c-3.487,5.576-5.357,11.596-5.357,17.599 c0.009,4.58,1.136,8.808,2.963,12.374c8.554,16.62,18.508,35.006,18.482,54.248v0.078c-0.009,5.776-1.101,10.398-3.286,14.148 l-2.167,3.706l1.006,0.585c-13.563,21.846-24.948,50.185-30.786,88.136c-1.249,8.039-1.835,16.279-1.835,24.633 c0.009,26.766,6.047,54.756,16.752,81.853c16.096,40.608,42.705,79.345,76.723,108.417c17.032,14.515,35.933,26.617,56.381,35.111 c20.212,8.407,41.944,13.248,64.63,13.378h0.664c12.662,0,25.586-1.502,38.641-4.666l0.14-0.035c0,0,0.192-0.053,0.235-0.062 c16.524-4.526,31.843-14.034,45.632-26.766c20.666-19.163,38.143-45.798,50.701-76.592c12.539-30.82,20.098-65.87,20.106-101.976 c0-37.611-8.397-76.374-28.242-111.844c1.381-1.154,2.744-2.316,4.151-3.434c10.232-8.196,20.963-15.588,30.558-23.48 c5.286-4.369,9.219-9.813,11.684-15.659c2.463-5.846,3.46-11.963,3.46-17.905C452.099,121.56,450.317,113.756,447.45,106.451z M101.488,70.614c1.476-2.351,4.273-5.558,9.166-9.219c3.845-2.892,7.585-4.788,10.949-5.96c3.374-1.171,6.37-1.617,8.599-1.608 c1.424-0.009,2.499,0.174,3.11,0.35c2.002,3.137,4.212,7.052,6.519,11.281c3.88,7.061,7.961,14.794,12.593,21.34 c2.001,2.805,4.106,5.391,6.605,7.707c-5.548,5.864-12.652,12.076-20.544,19.268c-5.714,5.2-11.822,10.984-18.001,17.538 c-1.407-10.101-4.518-19.783-7.916-28.364c-2.29-5.785-4.736-11.064-6.956-15.572c-2.211-4.491-4.194-8.232-5.496-10.766 c-0.157-0.314-0.289-0.69-0.289-1.355C99.836,74.424,100.028,72.991,101.488,70.614z M426.241,138.048 c-1.04,2.412-2.49,4.457-4.753,6.344c-11.203,9.271-26.643,19.374-41.367,32.62c-7.367,6.632-14.558,14.095-20.92,22.746 c-6.362,8.642-11.876,18.5-15.808,29.772c-1.826,5.234,0.917,10.931,6.143,12.757c5.208,1.835,10.923-0.917,12.758-6.143 c3.224-9.219,7.707-17.258,13.038-24.529c2.079-2.831,4.299-5.54,6.615-8.144c16.961,31.02,24.232,64.979,24.24,98.499 c0.035,43.482-12.312,86.108-31.082,119.209c-9.376,16.551-20.326,30.716-31.93,41.438c-11.552,10.705-23.689,17.913-35.39,21.129 c-11.106,2.683-22.029,3.933-32.743,3.933c-25.874,0-50.614-7.305-73.412-19.959c-34.15-18.962-63.738-50.053-84.57-85.304 c-36.763-62.06-43.648-137.63-8.109-201.945c14.977-27.054,33.424-43.237,49.756-58.005c8.162-7.393,15.826-14.401,22.047-22.571 c3.11-4.099,5.837-8.486,7.916-13.326c2.098-4.841,3.531-10.102,4.072-15.738c0.507-4.946,0.664-9.368,0.664-13.283 c0-16.096-3.958-28.504,15.607-31.746c3.556-0.603,7.48-0.935,11.308-0.935c4.264-0.009,8.406,0.428,11.752,1.249 c3.364,0.813,5.847,2.062,7.017,3.076c0.953,0.786,1.476,1.363,1.738,1.713c0.368,0.524,0.262,0.402,0.35,0.673 c0.07,0.253,0.158,1.075,0.148,2.682c0,0.481,0,1.005,0,1.608c0,1.922,0.149,4.177,0.498,6.763 c1.984,14.541,10.373,30.34,27.255,30.271c3.286,0.017,6.431-0.752,9.14-1.958c4.788-2.132,8.345-5.383,11.299-8.791 c4.412-5.138,7.602-10.914,10.206-15.93c1.276-2.508,2.402-4.832,3.321-6.702c0.446-0.909,0.856-1.713,1.205-2.368l0.612-0.008 c2.149-0.035,6.003,0.655,10.11,2.062c6.204,2.08,13.134,5.715,17.896,9.455c2.377,1.852,4.203,3.732,5.156,5.103 c0.454,0.638,0.708,1.136,0.82,1.433c-2.49,5.854-6.055,11.736-9.411,18.15c-6.397,12.233-9.377,25.48-3.076,38.308 c-16.943,15.267-31.869,31.887-44.478,49.538c-24.144,33.836-39.856,71.472-45.108,110.436c-0.725,5.479,3.111,10.521,8.599,11.247 c5.47,0.743,10.512-3.093,11.255-8.572c4.762-35.409,19.094-70.013,41.56-101.471c22.449-31.467,53.051-59.771,90.145-82.446 c2.473-1.494,4.658-2.036,7.078-2.054c3.032,0,6.58,1.022,10.356,3.294c5.644,3.356,11.447,9.446,15.528,16.508 c4.151,7.043,6.546,14.959,6.502,21.443C427.797,132.797,427.255,135.628,426.241,138.048z"/>
                  </g>
                  
                  <!-- Cora√ß√µes das Obras da Carne - Renderizados via JavaScript -->
                  <g id="obras-coracoes-container"></g>
                </svg>
                
                <!-- Labels HTML sobrepostos -->
                <div class="obras-labels-overlay">
                  <template x-for="(obra, index) in OBRAS_DA_CARNE" :key="index">
                    <div class="obra-label-overlay" 
                         :style="getPosicaoLabelObra(index)"
                         :class="{ 'ativa': isObraAtiva(index) }"
                         :title="obra + (isObraAtiva(index) ? ' (Ativa)' : ' (Inativa)')">
                      <div class="obra-label-nome" x-text="obra"></div>
                      <div class="obra-label-percentual" x-text="getPercentualObra(index) + '/100'"></div>
                    </div>
                  </template>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Leitura B√≠blia -->
        <div x-show="pagina === 'leitura-biblia'" style="display: none;">
          <!-- Lista de livros (AT / NT em grid ou lista) -->
          <template x-if="viewBiblia === 'livros'">
            <div>
              <div class="d-flex justify-content-between align-items-center mb-3">
                <h2 class="mb-0 fw-600">Leitura da B√≠blia</h2>
                <div class="btn-group btn-group-sm">
                  <button type="button" class="btn" :class="gridOuListaBiblia === 'grid' ? 'btn-primario' : 'btn-outline-secondary'" @click="gridOuListaBiblia = 'grid'"><i class="bi bi-grid-3x3-gap"></i></button>
                  <button type="button" class="btn" :class="gridOuListaBiblia === 'lista' ? 'btn-primario' : 'btn-outline-secondary'" @click="gridOuListaBiblia = 'lista'"><i class="bi bi-list-ul"></i></button>
                </div>
              </div>
              <p class="texto-secundario fs-menor mb-2">Antigo Testamento</p>
              <div class="mb-4" :class="gridOuListaBiblia === 'grid' ? 'row g-2' : ''">
                <template x-for="livro in livrosAT" :key="livro.codigo">
                  <div :class="gridOuListaBiblia === 'grid' ? 'col-4' : 'mb-2'" @click="selecionarLivroParaCapitulos(livro)">
                    <div class="card-tema p-2 text-center cursor-pointer h-100">
                      <span class="fw-600 d-block text-truncate" x-text="livro.nome"></span>
                      <div class="progress progresso-xp mt-1" style="height: 4px;">
                        <div class="barra" :style="'width:' + percentualLivro(livro.codigo) + '%'"></div>
                      </div>
                      <span class="fs-menor texto-secundario" x-text="percentualLivro(livro.codigo) + '%'"></span>
                    </div>
                  </div>
                </template>
              </div>
              <p class="texto-secundario fs-menor mb-2">Novo Testamento</p>
              <div :class="gridOuListaBiblia === 'grid' ? 'row g-2' : ''">
                <template x-for="livro in livrosNT" :key="livro.codigo">
                  <div :class="gridOuListaBiblia === 'grid' ? 'col-4' : 'mb-2'" @click="selecionarLivroParaCapitulos(livro)">
                    <div class="card-tema p-2 text-center cursor-pointer h-100">
                      <span class="fw-600 d-block text-truncate" x-text="livro.nome"></span>
                      <div class="progress progresso-xp mt-1" style="height: 4px;">
                        <div class="barra" :style="'width:' + percentualLivro(livro.codigo) + '%'"></div>
                      </div>
                      <span class="fs-menor texto-secundario" x-text="percentualLivro(livro.codigo) + '%'"></span>
                    </div>
                  </div>
                </template>
              </div>
            </div>
          </template>

          <!-- Cap√≠tulos do livro selecionado -->
          <template x-if="viewBiblia === 'capitulos' && livroSelecionadoParaCapitulos">
            <div>
              <button type="button" class="btn btn-link btn-sm p-0 mb-2 texto-primario" @click="voltarBibliaLivros()"><i class="bi bi-arrow-left"></i> Livros</button>
              <div class="d-flex justify-content-between align-items-center mb-3">
                <h2 class="mb-0 fw-600" x-text="livroSelecionadoParaCapitulos.nome"></h2>
                <div class="btn-group btn-group-sm">
                  <button type="button" class="btn" :class="gridOuListaBiblia === 'grid' ? 'btn-primario' : 'btn-outline-secondary'" @click="gridOuListaBiblia = 'grid'"><i class="bi bi-grid-3x3-gap"></i></button>
                  <button type="button" class="btn" :class="gridOuListaBiblia === 'lista' ? 'btn-primario' : 'btn-outline-secondary'" @click="gridOuListaBiblia = 'lista'"><i class="bi bi-list-ul"></i></button>
                </div>
              </div>
              <div class="mb-2 texto-secundario fs-menor" x-text="'Leitura: ' + percentualLivro(livroSelecionadoParaCapitulos.codigo) + '%'"></div>
              <div :class="gridOuListaBiblia === 'grid' ? 'row g-2' : ''">
                <template x-for="cap in Array.from({length: livroSelecionadoParaCapitulos.totalCapitulos}, (_, i) => i + 1)" :key="cap">
                  <div :class="gridOuListaBiblia === 'grid' ? 'col-4' : 'mb-2'" @click="selecionarCapituloParaLeitura(livroSelecionadoParaCapitulos, cap)">
                    <div class="card-tema p-2 text-center cursor-pointer h-100">
                      <span class="fw-600" x-text="'Cap. ' + cap"></span>
                      <div class="progress progresso-xp mt-1" style="height: 4px;">
                        <div class="barra" :style="'width:' + percentualCapitulo(livroSelecionadoParaCapitulos.codigo, cap) + '%'"></div>
                      </div>
                      <span class="fs-menor texto-secundario" x-text="percentualCapitulo(livroSelecionadoParaCapitulos.codigo, cap) + '%'"></span>
                    </div>
                  </div>
                </template>
              </div>
              <div class="mt-3" x-show="quizDesbloqueado(livroSelecionadoParaCapitulos.codigo)">
                <button type="button" class="btn btn-primario w-100" @click="iniciarQuizLivro(livroSelecionadoParaCapitulos)"><i class="bi bi-patch-question me-1"></i> Fazer quiz do livro</button>
              </div>
              <div class="mt-2" x-show="livroAprovado(livroSelecionadoParaCapitulos.codigo)">
                <span class="badge bg-success"><i class="bi bi-check-circle me-1"></i> Quiz aprovado</span>
              </div>
            </div>
          </template>

          <!-- Leitura do cap√≠tulo -->
          <template x-if="viewBiblia === 'leitura'">
            <div>
              <button type="button" class="btn btn-link btn-sm p-0 mb-2 texto-primario" @click="voltarParaCapitulosBiblia()"><i class="bi bi-arrow-left"></i> Cap√≠tulos</button>
              <h2 class="mb-2 fw-600" x-text="(livrosBiblia.find(l => l.codigo === livroSelecionado)?.nome || livroSelecionado) + ' ' + capituloSelecionado"></h2>
              <div x-show="capituloBiblia && !carregandoCapitulo" class="mb-2">
                <div class="d-flex justify-content-between align-items-center fs-menor texto-secundario mb-1">
                  <span>Leitura</span>
                  <span x-text="Math.round(progressoLeituraScroll || 0) + '%'"></span>
                </div>
                <div class="progress progresso-xp" style="height: 8px;">
                  <div class="barra" :style="'width:' + Math.min(100, Math.round(progressoLeituraScroll || 0)) + '%'"></div>
                </div>
                <div class="d-flex gap-2 flex-wrap align-items-center mt-2">
                  <button type="button" class="btn btn-sm btn-outline-secondary" @click="narrando ? pararNarracao() : narrarCapitulo()" :disabled="!(capituloBiblia?.verses?.length)">
                    <i :class="narrando ? 'bi bi-stop-circle' : 'bi bi-volume-up'"></i> <span x-text="narrando ? 'Parar narra√ß√£o' : 'Narrar cap√≠tulo'"></span>
                  </button>
                  <button type="button" class="btn btn-sm btn-outline-secondary" @click="modoNota = true; mostrarCoresMarcador = false">
                    <i class="bi bi-chat-quote"></i> Nova nota
                  </button>
                  <span class="fs-menor texto-secundario">Marcar texto:</span>
                  <div x-show="mostrarCoresMarcador" class="d-flex gap-1 ms-1">
                    <template x-for="cor in CORES_MARCADOR" :key="cor.valor">
                      <button type="button" class="btn btn-sm border rounded p-2" :class="{ 'border-primary border-3': corMarcadorAtiva === cor.valor }" :style="'background:' + cor.valor" :title="cor.nome" @click="corMarcadorAtiva = (corMarcadorAtiva === cor.valor ? null : cor.valor)"></button>
                    </template>
                  </div>
                  <span x-show="modoNota" class="fs-menor texto-secundario">Selecione o trecho e solte para abrir o campo da nota.</span>
                </div>
              </div>
              <div x-show="carregandoCapitulo" class="text-center py-4"><div class="spinner-border text-success"></div></div>
              <div x-show="capituloBiblia && !carregandoCapitulo" class="card-tema p-3">
                <div class="conteudo-leitura-biblia" @scroll="onScrollLeitura($event)" @mousedown="iniciarLongPressLeitura($event)" @touchstart="iniciarLongPressLeitura($event)" @mouseup="cancelarLongPressLeitura(); onSoltarLeitura($event)" @touchend="cancelarLongPressLeitura(); onSoltarLeitura($event)" @click="onClickConteudoLeitura($event)">
                  <template x-for="v in (capituloBiblia?.verses || [])" :key="v.verse">
                    <p class="mb-2 verso-biblia"><span class="texto-primario fw-600" x-text="v.verse + '.'"></span> <span class="verso-texto" :data-verse="v.verse" x-html="renderVersoHtml(v.verse, v.text)"></span></p>
                  </template>
                </div>
                <div x-show="Math.round(progressoLeituraScroll || 0) >= 100" class="d-flex flex-wrap gap-2 mt-3 align-items-center">
                  <button type="button" class="btn btn-outline-secondary btn-sm" @click="voltarParaCapitulosBiblia()"><i class="bi bi-arrow-left"></i> Voltar</button>
                  <button type="button" class="btn btn-primario btn-sm" @click="iniciarQuizCapitulo()"><i class="bi bi-patch-question"></i> Quiz do cap√≠tulo</button>
                  <button x-show="quizDesbloqueado(livroSelecionado)" type="button" class="btn btn-outline-primary btn-sm" @click="iniciarQuizLivro(livrosBiblia.find(l => l.codigo === livroSelecionado))"><i class="bi bi-journal-bookmark"></i> Quiz do livro</button>
                  <button type="button" class="btn btn-primario btn-sm" @click="avancarCapituloBiblia()"><i class="bi bi-arrow-right"></i> Avan√ßar</button>
                  <span x-show="!livroAprovado(livroSelecionado)" class="fs-menor texto-secundario">Avan√ßar sem aprovar no quiz do livro (‚â•70%) n√£o contabiliza o progresso do livro.</span>
                </div>
              </div>
            </div>
          </template>

          <!-- Popup de nota (marca-texto) -->
          <div x-show="notaPopup.aberto" class="modal-nota-overlay" @click.self="fecharNotaPopup()" x-transition>
            <div class="modal-nota card-tema p-3" role="dialog" aria-label="Nota">
              <h3 class="fs-6 fw-600 mb-2" x-text="notaPopup.id ? 'Sua nota' : 'Nova nota'"></h3>
              <p x-show="notaPopup.textoRef" class="fs-menor texto-secundario mb-2"><em x-text="'Trecho: ' + (notaPopup.textoRef || '')"></em></p>
              <textarea class="form-control mb-3" rows="4" x-model="notaPopup.conteudo" placeholder="Escreva sua nota..."></textarea>
              <div class="d-flex gap-2 justify-content-end">
                <button type="button" class="btn btn-outline-secondary btn-sm" @click="fecharNotaPopup()">Fechar</button>
                <button x-show="notaPopup.id" type="button" class="btn btn-outline-danger btn-sm" @click="removerNotacao(notaPopup.id)">Excluir</button>
                <button type="button" class="btn btn-primario btn-sm" @click="salvarEdicaoNota()" x-text="notaPopup.id ? 'Salvar' : 'Criar nota'"></button>
              </div>
            </div>
          </div>

          <!-- Quiz do livro -->
          <template x-if="viewBiblia === 'quiz' && quizLivroAtivo">
            <div>
              <button type="button" class="btn btn-link btn-sm p-0 mb-2 texto-primario" @click="fecharQuiz()"><i class="bi bi-arrow-left"></i> Voltar</button>
              <h2 class="mb-3 fw-600"><span x-text="quizTipo === 'capitulo' ? 'Quiz do cap√≠tulo' : 'Quiz do livro'"></span>: <span x-text="quizLivroAtivo.nome"></span><span x-show="quizTipo === 'capitulo'" x-text="' ' + capituloSelecionado"></span></h2>
              <p class="texto-secundario fs-menor mb-3" x-show="quizTipo === 'livro'">Aprova√ß√£o com nota m√≠nima de 70%. Abaixo disso, o progresso do livro √© resetado.</p>
              <p class="texto-secundario fs-menor mb-3" x-show="quizTipo === 'capitulo'">5 perguntas sobre o texto. Nota m√≠nima 70% para aprovar.</p>
              
              <!-- Aviso de cora√ß√µes insuficientes -->
              <div class="alert alert-warning mb-3" x-show="!temCoracoesSuficientes()">
                <i class="bi bi-heartbreak me-2"></i>
                <strong>Sem cora√ß√µes!</strong> Voc√™ precisa de pelo menos 1 cora√ß√£o para fazer o quiz.
                <div class="mt-2">
                  <button type="button" class="btn btn-sm btn-outline-primary me-2" @click="orarParaGanharCoracao()">
                    <i class="bi bi-heart me-1"></i> Orar (ganha 1 cora√ß√£o)
                  </button>
                  <a href="#loja" class="btn btn-sm btn-outline-primary">
                    <i class="bi bi-shop me-1"></i> Comprar cora√ß√µes
                  </a>
                </div>
              </div>
              
              <!-- Quiz em andamento - uma pergunta por vez -->
              <div x-show="!quizEnviado && quizPerguntas && quizPerguntas.length > 0 && temCoracoesSuficientes()" class="quiz-container-duolingo" style="display: none;">
                <!-- Barra de progresso -->
                <div class="quiz-progresso mb-3">
                  <div class="quiz-progresso-bar" :style="'width: ' + ((quizPerguntaAtual + 1) / quizPerguntas.length * 100) + '%'"></div>
                  <span class="quiz-progresso-texto" x-text="(quizPerguntaAtual + 1) + ' / ' + quizPerguntas.length"></span>
                </div>
                
                <!-- Pergunta atual com anima√ß√£o de slide -->
                <div class="quiz-pergunta-wrapper" x-transition:enter="quiz-slide-enter" x-transition:enter-start="quiz-slide-enter-start" x-transition:enter-end="quiz-slide-enter-end">
                  <div class="quiz-pergunta-card card-tema p-4">
                    <h3 class="quiz-pergunta-titulo mb-4" x-text="quizPerguntas[quizPerguntaAtual]?.pergunta"></h3>
                    
                    <div class="quiz-alternativas">
                      <template x-for="(op, oi) in quizPerguntas[quizPerguntaAtual]?.opcoes" :key="oi">
                        <button 
                          type="button"
                          class="quiz-alternativa-btn"
                          :class="{
                            'quiz-alternativa-selecionada': quizRespostaSelecionada === oi,
                            'quiz-alternativa-correta': quizFeedback === 'correto' && oi === quizPerguntas[quizPerguntaAtual]?.correta,
                            'quiz-alternativa-errada': quizFeedback === 'errado' && quizRespostaSelecionada === oi && oi !== quizPerguntas[quizPerguntaAtual]?.correta
                          }"
                          @click="selecionarRespostaQuizLivro(oi)"
                          :disabled="quizFeedback !== null">
                          <span class="quiz-alternativa-texto" x-text="op"></span>
                          <i x-show="quizFeedback === 'correto' && oi === quizPerguntas[quizPerguntaAtual]?.correta" class="bi bi-check-circle-fill quiz-feedback-icon"></i>
                          <i x-show="quizFeedback === 'errado' && quizRespostaSelecionada === oi" class="bi bi-x-circle-fill quiz-feedback-icon"></i>
                        </button>
                      </template>
                    </div>
                  </div>
                </div>
              </div>
              <template x-if="quizEnviado">
                <div class="card-tema p-3">
                  <p class="fw-600" x-text="'Sua nota: ' + quizNota + '%'"></p>
                  <p x-show="quizNota >= 70" class="text-success mb-0">Aprovado! Livro conclu√≠do.</p>
                  <p x-show="quizNota < 70" class="text-danger mb-0">Reprovado. O progresso do livro foi resetado. Leia novamente e refa√ßa o quiz.</p>
                  <button type="button" class="btn btn-outline-secondary mt-3" @click="fecharQuiz()">Voltar aos cap√≠tulos</button>
                </div>
              </template>
            </div>
          </template>
        </div>

        <!-- Ranking -->
        <div x-show="pagina === 'ranking'" style="display: none;">
          <h2 class="titulo-pagina mb-1">Ranking</h2>
          <p class="subtitulo-pagina mb-3">Compare seu n√≠vel e XP com outros jogadores</p>
          <template x-for="(r, i) in ranking" :key="r.usuario_id">
            <div class="card-tema p-3 mb-2 d-flex justify-content-between align-center">
              <span class="fw-600" x-text="(i + 1) + '. ' + (r.nome_exibicao || 'An√¥nimo')"></span>
              <span class="fs-menor" x-text="'N√≠vel ' + r.nivel + ' ¬∑ ' + r.xp_total + ' XP'"></span>
            </div>
          </template>
        </div>

        <!-- Configura√ß√µes -->
        <div x-show="pagina === 'configuracoes'" style="display: none;">
          <h2 class="titulo-pagina mb-2">Configura√ß√µes</h2>
          <p class="subtitulo-pagina mb-3">Apar√™ncia e informa√ß√µes do app</p>
          <div class="card-tema p-3 mb-3">
            <label class="form-label fw-600">Tema</label>
            <select class="form-select" :value="temaSalvo || 'claro'" @change="aplicarTema($event.target.value)">
              <option value="claro">Claro</option>
              <option value="escuro">Escuro</option>
              <option value="sistema">Sistema</option>
            </select>
            <p class="fs-menor texto-secundario mt-2 mb-0">Define cores claras, escuras ou segue o do dispositivo.</p>
          </div>
          <p class="subtitulo-secao mb-2">Informa√ß√µes legais e sobre o app</p>
          <a href="#termos" class="config-item">
            <span class="config-item-icone"><i class="bi bi-file-text"></i></span>
            <div class="config-item-texto">
              <span class="config-item-titulo">Termos de Uso</span>
              <p class="config-item-desc">Pol√≠tica de privacidade e condi√ß√µes de uso</p>
            </div>
            <i class="bi bi-chevron-right config-item-seta"></i>
          </a>
          <a href="#sobre" class="config-item">
            <span class="config-item-icone"><i class="bi bi-info-circle"></i></span>
            <div class="config-item-texto">
              <span class="config-item-titulo">Sobre o projeto</span>
              <p class="config-item-desc">Nossa hist√≥ria, miss√£o e cr√©ditos</p>
            </div>
            <i class="bi bi-chevron-right config-item-seta"></i>
          </a>
          <a href="#doacoes" class="config-item">
            <span class="config-item-icone"><i class="bi bi-heart"></i></span>
            <div class="config-item-texto">
              <span class="config-item-titulo">Doa√ß√µes</span>
              <p class="config-item-desc">Apoiar o projeto com qualquer valor</p>
            </div>
            <i class="bi bi-chevron-right config-item-seta"></i>
          </a>
          <div class="mt-4 pt-2">
            <button type="button" class="btn btn-outline-danger w-100" @click="sair()">Sair</button>
          </div>
        </div>

        <!-- Termos (dentro do layout: rola entre header e footer) -->
        <div x-show="pagina === 'termos'" class="pagina-conteudo" style="display: none;">
          <a href="#configuracoes" class="nav-voltar"><i class="bi bi-arrow-left"></i> Voltar √†s configura√ß√µes</a>
          <h1 class="titulo-pagina">Termos de Uso e Pol√≠tica de Privacidade</h1>
          <p class="meta-termos">Vers√£o 1.0 ¬∑ √öltima atualiza√ß√£o: fevereiro de 2025</p>
          <div class="card-tema conteudo-legal">
            <p>Ao criar conta, voc√™ declara que <strong>leu, entendeu e aceitou</strong> estes Termos de Uso e a Pol√≠tica de Privacidade. O cadastro s√≥ √© permitido ap√≥s aceite expl√≠cito. Se n√£o concordar, n√£o utilize o servi√ßo.</p>
            <h2 class="subtitulo-secao">1. O que √© o aplicativo</h2>
            <p>Plataforma de crescimento espiritual e estudo b√≠blico com gamifica√ß√£o: miss√µes (humanas, espirituais, conhecimento, tarefa, casal), leitura da B√≠blia com progresso e quizzes, estudo do evangelho, pontos (XP), ouro, n√≠vel, streak, conquistas, itens e loja. O app √© <strong>gratuito</strong> e de uso pessoal e n√£o comercial.</p>
            <h2 class="subtitulo-secao">2. Aceite dos termos</h2>
            <p>√â obrigat√≥rio aceitar estes Termos e a Pol√≠tica de Privacidade para criar conta. O aceite √© registrado com data e hora. Menores de 18 anos devem ter autoriza√ß√£o de respons√°vel legal. Sem aceite, o cadastro n√£o √© realizado.</p>
            <h2 class="subtitulo-secao">3. Dados que coletamos (LGPD)</h2>
            <p>Em conformidade com a <strong>Lei Geral de Prote√ß√£o de Dados (LGPD)</strong>:</p>
            <table>
              <thead><tr><th>Dado</th><th>Finalidade</th></tr></thead>
              <tbody>
                <tr><td>Nome, e-mail, senha</td><td>Identifica√ß√£o, login e seguran√ßa</td></tr>
                <tr><td>Data de nascimento, estado civil</td><td>Personaliza√ß√£o e miss√µes de casal</td></tr>
                <tr><td>Avatar, prefer√™ncias (tema, notifica√ß√µes)</td><td>Experi√™ncia no app</td></tr>
                <tr><td>Progresso (leitura, miss√µes, quizzes)</td><td>Funcionamento do app (n√≠vel, XP, conquistas)</td></tr>
              </tbody>
            </table>
            <p><strong>N√£o vendemos</strong> seus dados. Podem ser compartilhados apenas com: Supabase (hospedagem), APIs de conte√∫do (texto b√≠blico, avatar) e autoridades quando exigido por lei.</p>
            <h2 class="subtitulo-secao">4. Armazenamento e seguran√ßa</h2>
            <p>Dados em servidores confi√°veis, com criptografia onde aplic√°vel (ex.: senhas). Medidas t√©cnicas e organizacionais para reduzir riscos de acesso n√£o autorizado ou vazamento.</p>
            <h2 class="subtitulo-secao">5. Seus direitos</h2>
            <p>Voc√™ tem direito a: confirmar e acessar seus dados, corrigir, anonimizar ou excluir, portabilidade e revogar consentimento. Para exercer, entre em contato pelo canal indicado ao final. Pode tamb√©m recorrer √† <strong>ANPD</strong> (Autoridade Nacional de Prote√ß√£o de Dados).</p>
            <h2 class="subtitulo-secao">6. Cookies e armazenamento local</h2>
            <p>Usamos armazenamento local (localStorage/sessionStorage) para prefer√™ncias e sess√£o. N√£o usamos cookies de rastreamento para publicidade de terceiros.</p>
            <h2 class="subtitulo-secao">7. Reten√ß√£o</h2>
            <p>Mantemos os dados enquanto sua conta existir. Ap√≥s exclus√£o, removemos ou anonimizamos em prazo compat√≠vel com a lei. O registro de aceite dos termos pode ser mantido para comprova√ß√£o.</p>
            <h2 class="subtitulo-secao">8. Altera√ß√µes</h2>
            <p>Podemos atualizar estes Termos quando necess√°rio. A vers√£o e a data ficam no topo. Altera√ß√µes relevantes podem ser comunicadas por e-mail ou aviso no app. Recomendamos consultar esta p√°gina periodicamente.</p>
            <h2 class="subtitulo-secao">9. Limita√ß√£o de responsabilidade</h2>
            <p>O aplicativo √© oferecido "como est√°". N√£o nos responsabilizamos por danos indiretos. Conte√∫do b√≠blico vem de APIs de terceiros; n√£o garantimos exatid√£o teol√≥gica ou editorial. Voc√™ √© respons√°vel por manter sua senha em sigilo.</p>
            <h2 class="subtitulo-secao">10. Conduta do usu√°rio</h2>
            <p>Compromete-se a fornecer informa√ß√µes verdadeiras, n√£o usar o servi√ßo para fins ilegais, n√£o acessar dados de outros usu√°rios e n√£o usar bots para burlar regras. Descumprimento pode resultar em suspens√£o ou exclus√£o da conta.</p>
            <h2 class="subtitulo-secao">11. Contato</h2>
            <p>Para d√∫vidas, acesso, corre√ß√£o ou exclus√£o de dados e revoga√ß√£o de consentimento:</p>
            <p><strong>E-mail:</strong> [inserir e-mail de contato do projeto]</p>
            <p>O controlador dos dados √© a pessoa ou entidade respons√°vel pelo aplicativo (identificada na p√°gina Sobre).</p>
            <h2 class="subtitulo-secao">12. Resumo do aceite</h2>
            <p>Ao marcar que aceita os Termos no cadastro, voc√™ confirma que leu e entendeu este documento, concorda com a coleta e o uso dos dados (LGPD), que o aceite ser√° registrado e que pode exercer seus direitos a qualquer momento. <strong>Sem o aceite, o cadastro n√£o ser√° realizado.</strong></p>
            <p class="mb-0 mt-3"><a href="#configuracoes" class="texto-primario">Voltar √†s configura√ß√µes</a></p>
          </div>
        </div>

        <!-- Sobre (dentro do layout) -->
        <div x-show="pagina === 'sobre'" class="pagina-conteudo" style="display: none;">
          <a href="#configuracoes" class="nav-voltar"><i class="bi bi-arrow-left"></i> Voltar √†s configura√ß√µes</a>
          <div class="sobre-hero">
            <div class="sobre-icone-app" aria-hidden="true"><i class="bi bi-book-heart"></i></div>
            <h1 class="titulo-pagina">Sobre o projeto</h1>
            <p class="subtitulo-pagina">Nossa hist√≥ria, miss√£o e como nasceu este app de crescimento espiritual.</p>
          </div>
          <div class="sobre-secao">
            <h2 class="subtitulo-secao"><i class="bi bi-heart"></i> Nossa miss√£o</h2>
            <p class="descricao">Queremos ajudar pessoas a organizar a vida de f√© de forma leve e envolvente: leitura da B√≠blia, ora√ß√£o, miss√µes do dia a dia e estudo do evangelho. Tudo em portugu√™s, com acessibilidade e, para quem gosta, uma pitada de gamifica√ß√£o ‚Äî sem tirar o foco do que realmente importa.</p>
          </div>
          <div class="sobre-secao">
            <h2 class="subtitulo-secao"><i class="bi bi-lightbulb"></i> Como nasceu</h2>
            <p class="descricao">Este projeto nasceu da vontade de unir tecnologia e f√©: um app gratuito onde voc√™ pode cumprir miss√µes (humanas, espirituais, de conhecimento e de tarefa), acompanhar sua leitura da B√≠blia com progresso e quizzes, ganhar XP e ouro, subir de n√≠vel e manter um streak. Para casais, h√° espa√ßo para miss√µes conjuntas. O objetivo √© tornar o crescimento espiritual mais acess√≠vel, organizado e, quando fizer sentido, at√© divertido.</p>
          </div>
          <div class="sobre-secao">
            <h2 class="subtitulo-secao"><i class="bi bi-people"></i> Para quem √©</h2>
            <p class="descricao">Para quem quer organizar a vida de f√© (leitura, ora√ß√£o, miss√µes), para casais que desejam miss√µes conjuntas e para quem curte gamifica√ß√£o sem deixar o foco no evangelho. O app √© 100% gratuito; h√° espa√ßo para doa√ß√µes para quem quiser apoiar o projeto.</p>
          </div>
          <div class="sobre-secao">
            <h2 class="subtitulo-secao"><i class="bi bi-tools"></i> Cr√©ditos e tecnologia</h2>
            <p class="descricao mb-2">Este app foi constru√≠do com as seguintes ferramentas e fontes de conte√∫do:</p>
            <ul class="mb-0">
              <li><strong>bible-api.com</strong> ‚Äî texto b√≠blico</li>
              <li><strong>Avataaars</strong> ‚Äî avatares personalizados</li>
              <li><strong>Supabase</strong> ‚Äî banco de dados e autentica√ß√£o</li>
              <li><strong>Bootstrap</strong> e <strong>Alpine.js</strong> ‚Äî interface e interatividade</li>
            </ul>
          </div>
          <div class="card-tema p-3 mt-3">
            <p class="mb-2"><a href="#termos" class="texto-primario">Termos de Uso e Pol√≠tica de Privacidade</a></p>
            <p class="mb-0"><a href="#doacoes" class="texto-primario">Apoiar com doa√ß√£o</a></p>
          </div>
        </div>

        <!-- Doa√ß√µes (dentro do layout) -->
        <div x-show="pagina === 'doacoes'" class="pagina-conteudo" style="display: none;">
          <a href="#configuracoes" class="nav-voltar"><i class="bi bi-arrow-left"></i> Voltar √†s configura√ß√µes</a>
          <div class="sobre-hero">
            <div class="sobre-icone-app" aria-hidden="true" style="background: linear-gradient(135deg, var(--cor-destaque) 0%, #b8923a 100%);"><i class="bi bi-heart"></i></div>
            <h1 class="titulo-pagina">Doa√ß√µes</h1>
            <p class="subtitulo-pagina">O projeto √© gratuito. Sua doa√ß√£o ajuda a manter e melhorar o app.</p>
          </div>
          <div class="bloco-info">
            <div class="bloco-info-icone"><i class="bi bi-currency-dollar"></i></div>
            <div>
              <div class="bloco-info-titulo">Como apoiar</div>
              <p class="bloco-info-desc mb-0">Se voc√™ quiser apoiar com qualquer valor, em breve disponibilizaremos um link para doa√ß√£o (Pix). Sua contribui√ß√£o ser√° usada para custos de infraestrutura e melhorias no aplicativo. Obrigado por considerar apoiar!</p>
            </div>
          </div>
          <p class="text-center mt-3"><a href="#sobre" class="texto-primario">Conhecer mais sobre o projeto</a></p>
        </div>
      </main>

      <!-- Navega√ß√£o inferior -->
      <nav class="nav-inferior" aria-label="Menu principal">
        <a href="#home" :class="{ ativo: pagina === 'home' }"><i class="bi bi-house"></i> In√≠cio</a>
        <a href="#missoes" :class="{ ativo: pagina === 'missoes' }"><i class="bi bi-flag"></i> Miss√µes</a>
        <a href="#leitura-biblia" :class="{ ativo: pagina === 'leitura-biblia' }"><i class="bi bi-book"></i> B√≠blia</a>
        <a href="#inventario" :class="{ ativo: pagina === 'inventario' }"><i class="bi bi-backpack"></i> Invent√°rio</a>
        <a href="#perfil" :class="{ ativo: pagina === 'perfil' }"><i class="bi bi-person"></i> Perfil</a>
      </nav>
    </div>
  </template>

  <!-- Termos (somente quando N√ÉO logado: tela √∫nica, sem header/footer) -->
  <div x-show="!usuario && pagina === 'termos'" class="pagina-conteudo pagina-standalone" style="display: none;">
    <a href="#login" class="nav-voltar"><i class="bi bi-arrow-left"></i> Voltar ao login</a>
    <h1 class="titulo-pagina">Termos de Uso e Pol√≠tica de Privacidade</h1>
    <p class="meta-termos">Vers√£o 1.0 ¬∑ √öltima atualiza√ß√£o: fevereiro de 2025</p>
    <div class="card-tema conteudo-legal">
      <p>Ao criar conta, voc√™ declara que <strong>leu, entendeu e aceitou</strong> estes Termos de Uso e a Pol√≠tica de Privacidade. O cadastro s√≥ √© permitido ap√≥s aceite expl√≠cito. Se n√£o concordar, n√£o utilize o servi√ßo.</p>

      <h2 class="subtitulo-secao">1. O que √© o aplicativo</h2>
      <p>Plataforma de crescimento espiritual e estudo b√≠blico com gamifica√ß√£o: miss√µes (humanas, espirituais, conhecimento, tarefa, casal), leitura da B√≠blia com progresso e quizzes, estudo do evangelho, pontos (XP), ouro, n√≠vel, streak, conquistas, itens e loja. O app √© <strong>gratuito</strong> e de uso pessoal e n√£o comercial.</p>

      <h2 class="subtitulo-secao">2. Aceite dos termos</h2>
      <p>√â obrigat√≥rio aceitar estes Termos e a Pol√≠tica de Privacidade para criar conta. O aceite √© registrado com data e hora. Menores de 18 anos devem ter autoriza√ß√£o de respons√°vel legal. Sem aceite, o cadastro n√£o √© realizado.</p>

      <h2 class="subtitulo-secao">3. Dados que coletamos (LGPD)</h2>
      <p>Em conformidade com a <strong>Lei Geral de Prote√ß√£o de Dados (LGPD)</strong>:</p>
      <table>
        <thead><tr><th>Dado</th><th>Finalidade</th></tr></thead>
        <tbody>
          <tr><td>Nome, e-mail, senha</td><td>Identifica√ß√£o, login e seguran√ßa</td></tr>
          <tr><td>Data de nascimento, estado civil</td><td>Personaliza√ß√£o e miss√µes de casal</td></tr>
          <tr><td>Avatar, prefer√™ncias (tema, notifica√ß√µes)</td><td>Experi√™ncia no app</td></tr>
          <tr><td>Progresso (leitura, miss√µes, quizzes)</td><td>Funcionamento do app (n√≠vel, XP, conquistas)</td></tr>
        </tbody>
      </table>
      <p><strong>N√£o vendemos</strong> seus dados. Podem ser compartilhados apenas com: Supabase (hospedagem), APIs de conte√∫do (texto b√≠blico, avatar) e autoridades quando exigido por lei.</p>

      <h2 class="subtitulo-secao">4. Armazenamento e seguran√ßa</h2>
      <p>Dados em servidores confi√°veis, com criptografia onde aplic√°vel (ex.: senhas). Medidas t√©cnicas e organizacionais para reduzir riscos de acesso n√£o autorizado ou vazamento.</p>

      <h2 class="subtitulo-secao">5. Seus direitos</h2>
      <p>Voc√™ tem direito a: confirmar e acessar seus dados, corrigir, anonimizar ou excluir, portabilidade e revogar consentimento. Para exercer, entre em contato pelo canal indicado ao final. Pode tamb√©m recorrer √† <strong>ANPD</strong> (Autoridade Nacional de Prote√ß√£o de Dados).</p>

      <h2 class="subtitulo-secao">6. Cookies e armazenamento local</h2>
      <p>Usamos armazenamento local (localStorage/sessionStorage) para prefer√™ncias e sess√£o. N√£o usamos cookies de rastreamento para publicidade de terceiros.</p>

      <h2 class="subtitulo-secao">7. Reten√ß√£o</h2>
      <p>Mantemos os dados enquanto sua conta existir. Ap√≥s exclus√£o, removemos ou anonimizamos em prazo compat√≠vel com a lei. O registro de aceite dos termos pode ser mantido para comprova√ß√£o.</p>

      <h2 class="subtitulo-secao">8. Altera√ß√µes</h2>
      <p>Podemos atualizar estes Termos quando necess√°rio. A vers√£o e a data ficam no topo. Altera√ß√µes relevantes podem ser comunicadas por e-mail ou aviso no app. Recomendamos consultar esta p√°gina periodicamente.</p>

      <h2 class="subtitulo-secao">9. Limita√ß√£o de responsabilidade</h2>
      <p>O aplicativo √© oferecido ‚Äúcomo est√°‚Äù. N√£o nos responsabilizamos por danos indiretos. Conte√∫do b√≠blico vem de APIs de terceiros; n√£o garantimos exatid√£o teol√≥gica ou editorial. Voc√™ √© respons√°vel por manter sua senha em sigilo.</p>

      <h2 class="subtitulo-secao">10. Conduta do usu√°rio</h2>
      <p>Compromete-se a fornecer informa√ß√µes verdadeiras, n√£o usar o servi√ßo para fins ilegais, n√£o acessar dados de outros usu√°rios e n√£o usar bots para burlar regras. Descumprimento pode resultar em suspens√£o ou exclus√£o da conta.</p>

      <h2 class="subtitulo-secao">11. Contato</h2>
      <p>Para d√∫vidas, acesso, corre√ß√£o ou exclus√£o de dados e revoga√ß√£o de consentimento:</p>
      <p><strong>E-mail:</strong> [inserir e-mail de contato do projeto]</p>
      <p>O controlador dos dados √© a pessoa ou entidade respons√°vel pelo aplicativo (identificada na p√°gina Sobre).</p>

      <h2 class="subtitulo-secao">12. Resumo do aceite</h2>
      <p>Ao marcar que aceita os Termos no cadastro, voc√™ confirma que leu e entendeu este documento, concorda com a coleta e o uso dos dados (LGPD), que o aceite ser√° registrado e que pode exercer seus direitos a qualquer momento. <strong>Sem o aceite, o cadastro n√£o ser√° realizado.</strong></p>
      <p class="mb-0 mt-3"><a href="#login" class="texto-primario">Voltar ao login</a></p>
    </div>
  </div>

  <!-- Sobre (somente quando N√ÉO logado) -->
  <div x-show="!usuario && pagina === 'sobre'" class="pagina-conteudo pagina-standalone" style="display: none;">
    <a href="#login" class="nav-voltar"><i class="bi bi-arrow-left"></i> Voltar ao login</a>
    <div class="sobre-hero">
      <div class="sobre-icone-app" aria-hidden="true"><i class="bi bi-book-heart"></i></div>
      <h1 class="titulo-pagina">Sobre o projeto</h1>
      <p class="subtitulo-pagina">Nossa hist√≥ria, miss√£o e como nasceu este app de crescimento espiritual.</p>
    </div>

    <div class="sobre-secao">
      <h2 class="subtitulo-secao"><i class="bi bi-heart"></i> Nossa miss√£o</h2>
      <p class="descricao">Queremos ajudar pessoas a organizar a vida de f√© de forma leve e envolvente: leitura da B√≠blia, ora√ß√£o, miss√µes do dia a dia e estudo do evangelho. Tudo em portugu√™s, com acessibilidade e, para quem gosta, uma pitada de gamifica√ß√£o ‚Äî sem tirar o foco do que realmente importa.</p>
    </div>

    <div class="sobre-secao">
      <h2 class="subtitulo-secao"><i class="bi bi-lightbulb"></i> Como nasceu</h2>
      <p class="descricao">Este projeto nasceu da vontade de unir tecnologia e f√©: um app gratuito onde voc√™ pode cumprir miss√µes (humanas, espirituais, de conhecimento e de tarefa), acompanhar sua leitura da B√≠blia com progresso e quizzes, ganhar XP e ouro, subir de n√≠vel e manter um streak. Para casais, h√° espa√ßo para miss√µes conjuntas. O objetivo √© tornar o crescimento espiritual mais acess√≠vel, organizado e, quando fizer sentido, at√© divertido.</p>
    </div>

    <div class="sobre-secao">
      <h2 class="subtitulo-secao"><i class="bi bi-people"></i> Para quem √©</h2>
      <p class="descricao">Para quem quer organizar a vida de f√© (leitura, ora√ß√£o, miss√µes), para casais que desejam miss√µes conjuntas e para quem curte gamifica√ß√£o sem deixar o foco no evangelho. O app √© 100% gratuito; h√° espa√ßo para doa√ß√µes para quem quiser apoiar o projeto.</p>
    </div>

    <div class="sobre-secao">
      <h2 class="subtitulo-secao"><i class="bi bi-tools"></i> Cr√©ditos e tecnologia</h2>
      <p class="descricao mb-2">Este app foi constru√≠do com as seguintes ferramentas e fontes de conte√∫do:</p>
      <ul class="mb-0">
        <li><strong>bible-api.com</strong> ‚Äî texto b√≠blico</li>
        <li><strong>Avataaars</strong> ‚Äî avatares personalizados</li>
        <li><strong>Supabase</strong> ‚Äî banco de dados e autentica√ß√£o</li>
        <li><strong>Bootstrap</strong> e <strong>Alpine.js</strong> ‚Äî interface e interatividade</li>
      </ul>
    </div>

    <div class="card-tema p-3 mt-3">
      <p class="mb-2"><a href="#termos" class="texto-primario">Termos de Uso e Pol√≠tica de Privacidade</a></p>
      <p class="mb-0"><a href="#doacoes" class="texto-primario">Apoiar com doa√ß√£o</a></p>
    </div>
  </div>

  <!-- Doa√ß√µes (somente quando N√ÉO logado) -->
  <div x-show="!usuario && pagina === 'doacoes'" class="pagina-conteudo pagina-standalone" style="display: none;">
    <a href="#login" class="nav-voltar"><i class="bi bi-arrow-left"></i> Voltar ao login</a>
    <div class="sobre-hero">
      <div class="sobre-icone-app" aria-hidden="true" style="background: linear-gradient(135deg, var(--cor-destaque) 0%, #b8923a 100%);"><i class="bi bi-heart"></i></div>
      <h1 class="titulo-pagina">Doa√ß√µes</h1>
      <p class="subtitulo-pagina">O projeto √© gratuito. Sua doa√ß√£o ajuda a manter e melhorar o app.</p>
    </div>
    <div class="bloco-info">
      <div class="bloco-info-icone"><i class="bi bi-currency-dollar"></i></div>
      <div>
        <div class="bloco-info-titulo">Como apoiar</div>
        <p class="bloco-info-desc mb-0">Se voc√™ quiser apoiar com qualquer valor, em breve disponibilizaremos um link para doa√ß√£o (Pix). Sua contribui√ß√£o ser√° usada para custos de infraestrutura e melhorias no aplicativo. Obrigado por considerar apoiar!</p>
      </div>
    </div>
    <p class="text-center mt-3"><a href="#sobre" class="texto-primario">Conhecer mais sobre o projeto</a></p>
  </div>

  <script>
    window.SUPABASE_URL = ''; // Substitua pela URL do seu projeto Supabase
    window.SUPABASE_ANON_KEY = ''; // Substitua pela chave anon do Supabase
  </script>
  <!-- Supabase UMD: exp√µe window.supabase (use createClient dele) -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
  <!-- Ordem importante: primeiro o m√≥dulo (registra Alpine.data), depois o Alpine -->
  <script type="module" src="assets/js/app.js"></script>
  <script defer src="https://unpkg.com/alpinejs@3.13.3/dist/cdn.min.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js').catch(function() {});
    }
    setTimeout(function() {
      var body = document.body;
      var aviso = document.getElementById('aviso-servidor');
      if (aviso && body && body.hasAttribute('x-cloak')) {
        aviso.style.display = 'block';
      }
    }, 4000);
  </script>
  <div id="aviso-servidor" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: var(--cor-fundo, #f5f5f0); padding: 2rem; z-index: 9999; overflow: auto;">
    <h2>P√°gina n√£o carregou</h2>
    <p>Abra o projeto com um <strong>servidor local</strong>. Na pasta do projeto, no terminal:</p>
    <pre style="background: #eee; padding: 1rem; border-radius: 8px;">npx serve .</pre>
    <p>Depois acesse <strong>http://localhost:3000</strong> (ou a porta que aparecer).</p>
  </div>
</body>
</html>
